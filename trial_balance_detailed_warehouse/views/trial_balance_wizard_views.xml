<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Inherit Trial Balance Wizard to add analytic filter and detail button -->
    <record id="account_report_balance_view_inherit" model="ir.ui.view">
        <field name="name">account.balance.report.inherit.warehouse</field>
        <field name="model">account.balance.report</field>
        <field name="inherit_id" ref="accounting_pdf_reports.account_report_balance_view"/>
        <field name="arch" type="xml">

            <!-- Add analytic account filter after display_account field -->
            <xpath expr="//field[@name='display_account']" position="after">
                <newline/>
                <field name="analytic_account_ids"
                       widget="many2many_tags"
                       options="{'no_create': True, 'color_field': 'color'}"
                       placeholder="Leave empty for all warehouses..."
                       help="Filter by specific analytic accounts (warehouses). Leave empty to show all."/>
                <newline/>
            </xpath>

            <!-- Add "Open Details" button in footer -->
            <xpath expr="//footer" position="inside">
                <button name="open_trial_balance"
                        string="Show Details"
                        type="object"
                        class="btn-primary"
                        help="Open detailed trial balance with journal item drill-down"/>
            </xpath>

        </field>
    </record>
</odoo>