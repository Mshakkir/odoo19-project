<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_order_tree_custom" model="ir.ui.view">
        <field name="name">sale.order.tree.custom</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_tree"/>
        <field name="arch" type="xml">
            <!-- Remove all existing fields first -->
            <xpath expr="//field[@name='name']" position="replace"/>
            <xpath expr="//field[@name='date_order']" position="replace"/>
            <xpath expr="//field[@name='partner_id']" position="replace"/>
            <xpath expr="//field[@name='user_id']" position="replace"/>
            <xpath expr="//field[@name='activity_ids']" position="replace"/>
            <xpath expr="//field[@name='amount_total']" position="replace"/>
            <xpath expr="//field[@name='invoice_status']" position="replace"/>

            <!-- Add fields in the desired order -->
            <xpath expr="//tree" position="inside">
                <!-- 1. Order Date -->
                <field name="date_order" string="Order Date" optional="show"/>

                <!-- 2. Number (Order Reference) -->
                <field name="name" string="Number" optional="show" decoration-bf="1"/>

                <!-- 3. Customer -->
                <field name="partner_id" string="Customer" optional="show"/>

                <!-- 4. Warehouse -->
                <field name="warehouse_id" optional="show" groups="stock.group_stock_multi_warehouses"/>

                <!-- 5. Customer Reference -->
                <field name="client_order_ref" string="Customer Reference" optional="show"/>

                <!-- 6. Salesperson -->
                <field name="user_id" string="Salesperson" optional="show" widget="many2one_avatar_user"/>

                <!-- 7. Untaxed Amount -->
                <field name="amount_untaxed" string="Tax Excluded" optional="show" sum="Total"/>

                <!-- 8. Tax -->
                <field name="amount_tax" string="Tax" optional="show" sum="Total"/>

                <!-- 9. Total Amount (Taxed) -->
                <field name="amount_total" string="Total" optional="show" sum="Total" decoration-bf="1"/>

                <!-- 10. Shipping Reference -->
                <field name="commitment_date" string="Shipping Ref" optional="hide"/>

                <!-- 11. PO Number (Customer PO) -->
                <field name="client_order_ref" string="PO Number" optional="hide"/>

                <!-- Additional useful fields -->
                <field name="state" string="Status" optional="show" widget="badge"
                       decoration-success="state == 'sale' or state == 'done'"
                       decoration-info="state == 'draft' or state == 'sent'"/>

                <field name="invoice_status" string="Invoice Status" optional="show" widget="badge"
                       decoration-success="invoice_status == 'invoiced'"
                       decoration-warning="invoice_status == 'to invoice'"
                       decoration-info="invoice_status == 'no'"/>

                <field name="activity_ids" string="Activities" optional="show" widget="list_activity"/>

                <!-- Hidden fields for filters -->
                <field name="company_id" invisible="1"/>
                <field name="pricelist_id" invisible="1"/>
                <field name="team_id" invisible="1"/>
            </xpath>
        </field>
    </record>
</odoo>