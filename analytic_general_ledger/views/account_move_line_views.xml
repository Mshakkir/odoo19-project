<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Custom tree view for general ledger details -->
    <record id="view_move_line_general_ledger_analytic_tree" model="ir.ui.view">
        <field name="name">account.move.line.general.ledger.analytic.tree</field>
        <field name="model">account.move.line</field>
        <field name="arch" type="xml">
            <tree string="General Ledger Details" create="false" delete="false" decoration-info="parent_state == 'draft'">
                <field name="date"/>
                <field name="move_id" string="Entry"/>
                <field name="journal_id"/>
                <field name="account_id"/>
                <field name="analytic_account_id" optional="show"/>
                <field name="partner_id" optional="show"/>
                <field name="name"/>
                <field name="ref" optional="hide"/>
                <field name="debit" sum="Total Debit"/>
                <field name="credit" sum="Total Credit"/>
                <field name="balance" sum="Balance"/>
                <field name="amount_currency" optional="hide" groups="base.group_multi_currency"/>
                <field name="currency_id" optional="hide" groups="base.group_multi_currency"/>
                <field name="parent_state" column_invisible="1"/>
                <button name="action_open_business_doc" type="object"
                        string="View Invoice/Payment"
                        class="btn-link"
                        icon="fa-external-link"
                        context="{'default_move_id': move_id}"/>
            </tree>
        </field>
    </record>

    <!-- Search view with filters -->
    <record id="view_move_line_general_ledger_analytic_search" model="ir.ui.view">
        <field name="name">account.move.line.general.ledger.analytic.search</field>
        <field name="model">account.move.line</field>
        <field name="arch" type="xml">
            <search>
                <field name="date"/>
                <field name="move_id"/>
                <field name="journal_id"/>
                <field name="account_id"/>
                <field name="analytic_account_id"/>
                <field name="partner_id"/>
                <field name="name" string="Label"/>
                <filter string="Receivable Accounts" name="receivable"
                        domain="[('account_id.account_type', '=', 'asset_receivable')]"/>
                <filter string="Payable Accounts" name="payable"
                        domain="[('account_id.account_type', '=', 'liability_payable')]"/>
                <separator/>
                <filter string="Sales" name="sales"
                        domain="[('journal_id.type', '=', 'sale')]"/>
                <filter string="Purchases" name="purchases"
                        domain="[('journal_id.type', '=', 'purchase')]"/>
                <filter string="Bank" name="bank"
                        domain="[('journal_id.type', '=', 'bank')]"/>
                <filter string="Cash" name="cash"
                        domain="[('journal_id.type', '=', 'cash')]"/>
                <separator/>
                <group expand="0" string="Group By">
                    <filter string="Account" name="group_by_account"
                            context="{'group_by': 'account_id'}"/>
                    <filter string="Analytic Account" name="group_by_analytic"
                            context="{'group_by': 'analytic_account_id'}"/>
                    <filter string="Journal" name="group_by_journal"
                            context="{'group_by': 'journal_id'}"/>
                    <filter string="Partner" name="group_by_partner"
                            context="{'group_by': 'partner_id'}"/>
                    <filter string="Date" name="group_by_date"
                            context="{'group_by': 'date'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Action for opening related invoice/payment -->
    <record id="action_view_move_from_line" model="ir.actions.act_window">
        <field name="name">Journal Entry</field>
        <field name="res_model">account.move</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

</odoo>