<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="custom_purchaseorder_report_clean" inherit_id="purchase.report_purchaseorder_document">

        <!-- REMOVE DEFAULT HEADER & FOOTER -->
        <xpath expr="//t[@t-call='web.external_layout']" position="replace">
            <t>
                <t t-foreach="docs" t-as="o">

                    <head>
                        <meta charset="UTF-8"/>
                        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
                        <style type="text/css">
                            /* Import Google Noto Arabic Font */
                            @import url('https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;700&amp;display=swap');

                            @page {
                            margin: 20mm;
                            }

                            body {
                            font-family: 'DejaVu Sans', Arial, sans-serif;
                            }

                            .ar {
                            font-family: 'Noto Naskh Arabic', 'DejaVu Sans', Arial, sans-serif !important;
                            direction: rtl;
                            unicode-bidi: bidi-override;
                            font-weight: 700;
                            display: inline-block;
                            }

                            table {
                            width: 100%;
                            border-collapse: collapse;
                            }

                            * {
                            box-sizing: border-box;
                            }
                        </style>
                    </head>

                    <body>
                        <div class="page">

                            <!-- TITLE -->
                            <div style="background:#ddd; padding:10px; text-align:center; margin-bottom:15px; font-weight:bold; font-size:16px;">
                                Purchase Order /
                                <span class="ar" style="font-size:18px;">أمر شراء</span>
                            </div>

                            <!-- VENDOR & SHIPPING DETAILS -->
                            <table style="margin-top:8px; font-size:13px;">
                                <tr>
                                    <td style="width:50%; vertical-align:top; border:1px solid #575656; padding:8px;">
                                        <div style="font-weight:bold; margin-bottom:5px;">
                                            Vendor &amp; Address /
                                            <span class="ar">البائع والعنوان</span>
                                        </div>
                                        <div>
                                            <span t-esc="o.partner_id.name"/>
                                        </div>
                                        <div>
                                            <span t-esc="o.partner_id.contact_address"/>
                                        </div>
                                    </td>

                                    <td style="width:50%; vertical-align:top; border:1px solid #575656; padding:8px;">
                                        <div style="font-weight:bold; margin-bottom:5px;">
                                            Ship To Address /
                                            <span class="ar">عنوان الشحن</span>
                                        </div>
                                        <div>
                                            <span t-esc="o.company_id.partner_id.contact_address"/>
                                        </div>
                                    </td>
                                </tr>
                            </table>

                            <!-- PO DETAILS -->
                            <table style="margin-top:8px; font-size:12px;">
                                <tr>
                                    <td style="border:1px solid #575656; padding:8px; width:33%;">
                                        <strong>PO Number:</strong>
                                        <span t-esc="o.name"/>
                                        <br/>
                                        <span class="ar" style="font-size:11px;">:رقم أمر الشراء</span>
                                    </td>
                                    <td style="border:1px solid #575656; padding:8px; width:33%;">
                                        <strong>Vendor Reference:</strong>
                                        <span t-esc="o.partner_ref or '-'"/>
                                        <br/>
                                        <span class="ar" style="font-size:11px;  line-height:12px; display:block;">:مرجع البائع</span>
                                    </td>
                                    <td style="border:1px solid #575656; padding:8px; width:34%;">
                                        <strong>Order Date:</strong>
                                        <span t-esc="o.date_order.strftime('%d-%b-%Y')"/>
                                        <br/>
                                        <span class="ar" style="font-size:11px;">:تاريخ الطلب</span>
                                    </td>
                                </tr>
                            </table>

                            <!-- ITEMS TABLE -->
                            <table style="margin-top:10px; font-size:12px; text-align:center; border:1px solid #000;">
                                <thead style="background-color:#d9d9d9; color:#080808; font-weight:bold;">
                                    <tr>
                                        <th style="padding:10px; border:1px solid #000; width:5%;">
                                            S.N
                                            <br/>
                                            <span class="ar" style="font-size:11px; font-weight:700;">م</span>
                                        </th>
                                        <th style="padding:10px; border:1px solid #000; width:35%;">
                                            Item / Description
                                            <br/>
                                            <span class="ar"
                                                  style="font-size:11px; font-weight:700; line-height:12px; display:block;">
                                                الصنف والوصف
                                            </span>
                                        </th>


                                        <th style="padding:10px; border:1px solid #000; width:12%;">
                                            Delivery
                                            <br/>
                                            <span class="ar" style="font-size:11px; font-weight:700;">التوصيل</span>
                                        </th>

                                        <th style="padding:10px; border:1px solid #000; width:8%;">
                                            QTY
                                            <br/>
                                            <span class="ar" style="font-size:11px; font-weight:700;">الكمية</span>
                                        </th>

                                        <th style="padding:10px; border:1px solid #000; width:10%;">
                                            Unit
                                            <br/>
                                            <span class="ar" style="font-size:11px; font-weight:700;">الوحدة</span>
                                        </th>

                                        <th style="padding:10px; border:1px solid #000; width:15%;">
                                            Unit Price
                                            <br/>
                                            <span class="ar" style="font-size:11px; font-weight:700;">سعر الوحدة</span>
                                        </th>

                                        <th style="padding:10px; border:1px solid #000; width:15%;">
                                            Total Price
                                            <br/>
                                            <span class="ar" style="font-size:11px; font-weight:700;">السعر الإجمالي
                                            </span>
                                        </th>
                                    </tr>
                                </thead>

                                <tbody>
                                    <t t-set="i" t-value="0"/>
                                    <t t-foreach="o.order_line" t-as="line">
                                        <t t-set="i" t-value="i + 1"/>
                                        <tr>
                                            <td style="padding:10px; border:1px solid #000;">
                                                <span t-esc="i"/>
                                            </td>
                                            <td style="padding:10px; border:1px solid #000; text-align:left;">
                                                <span t-esc="line.name"/>
                                            </td>
                                            <td style="padding:10px; border:1px solid #000;">
                                                <span t-esc="line.date_planned and line.date_planned.strftime('%d-%b-%Y') or '-'"/>
                                            </td>
                                            <td style="padding:10px; border:1px solid #000;">
                                                <span t-esc="line.product_qty"/>
                                            </td>
                                            <td style="padding:10px; border:1px solid #000;">
                                                <span t-esc="line.product_uom_id.name"/>
                                            </td>
                                            <td style="padding:10px; border:1px solid #000;">
                                                <span t-field="line.price_unit"
                                                      t-options='{"widget":"monetary", "display_currency":o.currency_id}'/>
                                            </td>
                                            <td style="padding:10px; border:1px solid #000;">
                                                <span t-field="line.price_subtotal"
                                                      t-options='{"widget":"monetary", "display_currency":o.currency_id}'/>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>

                            <!-- TOTALS -->
                            <table style="width:45%; margin-top:20px; float:right; font-size:13px;">
                                <tr>
                                    <td style="padding:10px; border:1px solid #000; width:60%;">
                                        <strong>Subtotal</strong>
                                        /
                                        <span class="ar" style="font-size:12px;">المجموع الفرعي</span>
                                    </td>
                                    <td style="padding:10px; border:1px solid #000; text-align:right; width:40%;">
                                        <span t-field="o.amount_untaxed"
                                              t-options='{"widget":"monetary", "display_currency":o.currency_id}'/>
                                    </td>
                                </tr>

                                <tr>
                                    <td style="padding:10px; border:1px solid #000;">
                                        <strong>VAT</strong>
                                        /
                                        <span class="ar" style="font-size:12px;">ضريبة القيمة المضافة</span>
                                    </td>
                                    <td style="padding:10px; border:1px solid #000; text-align:right;">
                                        <span t-field="o.amount_tax"
                                              t-options='{"widget":"monetary", "display_currency":o.currency_id}'/>
                                    </td>
                                </tr>

                                <tr style="background:#eee;">
                                    <td style="padding:12px; border:1px solid #000;">
                                        <strong>Net Total</strong>
                                        /
                                        <span class="ar" style="font-size:12px;">الإجمالي الصافي</span>
                                    </td>
                                    <td style="padding:12px; border:1px solid #000; text-align:right;">
                                        <strong>
                                            <span t-field="o.amount_total"
                                                  t-options='{"widget":"monetary", "display_currency":o.currency_id}'/>
                                        </strong>
                                    </td>
                                </tr>
                            </table>

                            <!-- Clear float -->
                            <div style="clear:both; height:20px;"></div>

                        </div>
                    </body>

                </t>
            </t>
        </xpath>

    </template>
</odoo>