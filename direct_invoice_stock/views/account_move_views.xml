<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Invoice Form View Inherit -->
    <record id="view_move_form_inherit_direct_invoice" model="ir.ui.view">
        <field name="name">account.move.form.inherit.direct.invoice</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">

            <!-- Add smart button for delivery order -->
            <xpath expr="//div[@name='button_box']" position="inside">
                <button name="action_view_delivery"
                        type="object"
                        class="oe_stat_button"
                        icon="fa-truck"
                        invisible="not picking_id"
                        groups="stock.group_stock_user">
                    <field name="picking_id" invisible="1"/>
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_text">Delivery</span>
                    </div>
                </button>
            </xpath>

            <!-- Add checkbox after partner_shipping_id -->
            <xpath expr="//field[@name='partner_shipping_id']" position="after">
                <label for="create_delivery"
                       string="ðŸšš Auto Create Delivery"
                       invisible="move_type != 'out_invoice'"/>
                <div invisible="move_type != 'out_invoice'">
                    <field name="create_delivery"
                           widget="boolean_toggle"
                           nolabel="1"/>
                </div>
            </xpath>

            <!-- Add warehouse field after create_delivery -->
            <xpath expr="//field[@name='create_delivery']" position="after">
                <field name="warehouse_id"
                       invisible="not create_delivery or move_type != 'out_invoice'"
                       options="{'no_create': True, 'no_open': True}"
                       placeholder="Auto-selected from Analytic Account"
                       string="Delivery Warehouse"/>
            </xpath>

        </field>
    </record>

</odoo>

<!--stock reduce issue solve below code usage-->
<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->

<!--    &lt;!&ndash; Invoice Form View Inherit &ndash;&gt;-->
<!--    <record id="view_move_form_inherit_direct_invoice" model="ir.ui.view">-->
<!--        <field name="name">account.move.form.inherit.direct.invoice</field>-->
<!--        <field name="model">account.move</field>-->
<!--        <field name="inherit_id" ref="account.view_move_form"/>-->
<!--        <field name="arch" type="xml">-->

<!--            &lt;!&ndash; Add smart button for delivery order &ndash;&gt;-->
<!--            <xpath expr="//div[@name='button_box']" position="inside">-->
<!--                <button name="action_view_delivery"-->
<!--                        type="object"-->
<!--                        class="oe_stat_button"-->
<!--                        icon="fa-truck"-->
<!--                        invisible="not picking_id"-->
<!--                        groups="stock.group_stock_user">-->
<!--                    <field name="picking_id" invisible="1"/>-->
<!--                    <div class="o_field_widget o_stat_info">-->
<!--                        <span class="o_stat_text">Delivery</span>-->
<!--                    </div>-->
<!--                </button>-->
<!--            </xpath>-->

<!--            &lt;!&ndash; Add checkbox and warehouse selector &ndash;&gt;-->
<!--            <xpath expr="//field[@name='partner_id']" position="after">-->
<!--                <field name="create_delivery"-->
<!--                       invisible="move_type != 'out_invoice'"-->
<!--                       widget="boolean_toggle"-->
<!--                       string="ðŸšš Auto Create Delivery Order"/>-->
<!--                <field name="warehouse_id"-->
<!--                       invisible="not create_delivery or move_type != 'out_invoice'"-->
<!--                       options="{'no_create': True, 'no_open': True}"-->
<!--                       placeholder="Auto-detect from Analytic Account or use default"/>-->
<!--            </xpath>-->

<!--        </field>-->
<!--    </record>-->

<!--</odoo>-->