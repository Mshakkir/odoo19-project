<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Inherit and customize the original report template -->
    <template id="report_agedpartnerbalance_custom" inherit_id="accounting_pdf_reports.report_agedpartnerbalance">

        <!-- CUSTOMIZATION 1: Modify the header section -->
        <xpath expr="//h2" position="replace">
            <div class="text-center">
                <h2 style="color: #875A7B;">Custom Aged Partner Balance Report</h2>
                <p class="text-muted">Generated on <span t-esc="report_date"/></p>
            </div>
        </xpath>

        <!-- CUSTOMIZATION 2: Add additional information in header -->
        <xpath expr="//div[@class='row mb32']" position="after">
            <div class="row mb16">
                <div class="col-4">
                    <strong>Company:</strong>
                    <p t-esc="company_name"/>
                </div>
                <div class="col-4">
                    <strong>Generated By:</strong>
                    <p t-esc="user_name"/>
                </div>
                <div class="col-4">
                    <strong>Total Partners:</strong>
                    <p><span t-esc="total_partners"/> (<span t-esc="partners_with_overdue"/> with overdue)</p>
                </div>
            </div>
        </xpath>

        <!-- CUSTOMIZATION 3: Add custom columns to the table -->
        <xpath expr="//table[@class='table table-sm table-reports']/thead/tr[1]/th[1]" position="after">
            <th>Email</th>
            <th>Phone</th>
            <th>City</th>
        </xpath>

        <!-- CUSTOMIZATION 4: Add data to custom columns in Account Total row -->
        <xpath expr="//table[@class='table table-sm table-reports']/thead/tr[2]/th[1]" position="after">
            <th colspan="3" class="text-center">Partner Details</th>
        </xpath>

        <!-- CUSTOMIZATION 5: Add data to custom columns in partner rows -->
        <xpath expr="//table[@class='table table-sm table-reports']/tbody/tr/td[1]" position="after">
            <td>
                <span t-esc="partner.get('email', '')"/>
            </td>
            <td>
                <span t-esc="partner.get('phone', '')"/>
            </td>
            <td>
                <span t-esc="partner.get('city', '')"/>
            </td>
        </xpath>

        <!-- CUSTOMIZATION 6: Add styling to overdue amounts (optional) -->
        <xpath expr="//table[@class='table table-sm table-reports']/tbody/tr/td[@class='text-end'][last()]" position="attributes">
            <attribute name="style">font-weight: bold;</attribute>
            <attribute name="t-attf-class">text-end #{partner['total'] &lt; 0 and 'text-danger' or (partner['total'] &gt; 0 and 'text-success' or '')}</attribute>
        </xpath>

        <!-- CUSTOMIZATION 7: Add summary section after the table -->
        <xpath expr="//table[@class='table table-sm table-reports']" position="after">
            <div class="row mt32" t-if="percentage_breakdown">
                <div class="col-12">
                    <h4>Aging Analysis</h4>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Period</th>
                                <th class="text-end">Amount</th>
                                <th class="text-end">Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Not Due</td>
                                <td class="text-end">
                                    <span t-esc="get_direction[6]" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-esc="'%.2f' % percentage_breakdown.get('not_due', 0)"/>%
                                </td>
                            </tr>
                            <tr t-foreach="range(5)" t-as="period_idx">
                                <td><span t-esc="data[str(4-period_idx)]['name']"/></td>
                                <td class="text-end">
                                    <span t-esc="get_direction[4-period_idx]" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">
                                    <span t-esc="'%.2f' % percentage_breakdown.get('period_' + str(4-period_idx), 0)"/>%
                                </td>
                            </tr>
                            <tr style="font-weight: bold; border-top: 2px solid #000;">
                                <td>Total</td>
                                <td class="text-end">
                                    <span t-esc="get_direction[5]" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                </td>
                                <td class="text-end">100.00%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </xpath>

    </template>

    <!-- Alternative: Create a completely new report template (uncomment if needed) -->
    <!--
    <template id="report_agedpartnerbalance_completely_custom">
        <t t-call="web.html_container">
            <t t-set="data_report_margin_top" t-value="12"/>
            <t t-set="data_report_header_spacing" t-value="9"/>
            <t t-set="data_report_dpi" t-value="110"/>
            <t t-call="web.internal_layout">
                <div class="page">
                    <h2 class="text-center">Your Completely Custom Report</h2>

                    <!- Add your completely custom HTML here -->

<!--                </div>-->
<!--            </t>-->
<!--        </t>-->
<!--    </template>-->
<!--    &ndash;&gt;-->

</odoo>