<?xml version="1.0" encoding="utf-8"?>
<templates xml:space="preserve">

    <!-- ═══════════════════════════════════════════════════════
         Autocomplete Input Widget
         ═══════════════════════════════════════════════════════ -->
    <t t-name="rack_list.FilterAutocomplete">
        <div class="rack_autocomplete_wrapper" t-ref="wrapper">
            <div class="rack_autocomplete_input_wrap">
                <input
                    type="text"
                    class="rack_filter_input"
                    t-att-placeholder="props.placeholder"
                    t-att-value="state.inputValue"
                    t-on-input="onInput"
                    t-on-keydown="onKeyDown"
                    autocomplete="off"
                />
                <button
                    t-if="hasValue"
                    class="rack_clear_btn"
                    t-on-click="onClearClick"
                    title="Clear"
                >&#x2715;</button>
            </div>
            <ul t-if="state.open" class="rack_dropdown">
                <t t-foreach="state.suggestions" t-as="opt" t-key="opt.id">
                    <li
                        class="rack_dropdown_item"
                        t-att-class="{ active: opt_index === state.activeIdx }"
                        t-on-click="() => selectOption(opt)"
                        t-on-mouseenter="() => { state.activeIdx = opt_index; }"
                    >
                        <t t-esc="opt.label"/>
                    </li>
                </t>
            </ul>
        </div>
    </t>

    <!-- ═══════════════════════════════════════════════════════
         Filter Bar (Product + Location)
         ═══════════════════════════════════════════════════════ -->
    <t t-name="rack_list.FilterBar">
        <div class="rack_filter_bar">
            <FilterAutocomplete
                placeholder="Product"
                fetchOptions="fetchProducts"
                onSelect="onProductSelect"
                onClear="onProductClear"
            />
            <FilterAutocomplete
                placeholder="Location"
                fetchOptions="fetchLocations"
                onSelect="onLocationSelect"
                onClear="onLocationClear"
            />
            <button class="rack_apply_btn" t-on-click="onApply">Apply</button>
            <button class="rack_clear_all_btn" t-on-click="onClearAll">Clear</button>
        </div>
    </t>

    <!-- ═══════════════════════════════════════════════════════
         List Controller — inject filter bar above the list
         ═══════════════════════════════════════════════════════ -->
    <t t-name="rack_list.ListController" t-inherit="web.ListController" t-inherit-mode="extension">
        <xpath expr="//Layout" position="inside">
            <t t-set-slot="control-panel-bottom-left">
                <RackListFilterBar/>
            </t>
        </xpath>
    </t>

</templates>