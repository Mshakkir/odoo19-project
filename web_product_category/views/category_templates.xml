<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Dynamic Product Categories Template -->
        <template id="dynamic_product_categories" name="Dynamic Product Categories">
            <t t-call="web.layout">
                <div class="container my-5">
                    <h2 class="text-center mb-4">Explore Our Product Categories</h2>

                    <div class="category-tabs d-flex flex-wrap justify-content-center gap-2 mb-4">
                        <t t-foreach="categories" t-as="category">
                            <button class="cat-btn" t-att-data-category-id="category.id">
                                <t t-esc="category.name"/>
                            </button>
                        </t>
                    </div>

                    <div class="category-content">
                        <t t-foreach="categories" t-as="category">
                            <div t-att-id="'cat-' + str(category.id)" class="cat-panel">
                                <div class="row align-items-center">
                                    <div class="col-md-6">
                                        <h3><t t-esc="category.name"/></h3>
                                        <div t-if="category.description" class="category-description">
                                            <t t-raw="category.description"/>
                                        </div>
                                        <div t-else="" class="category-description">
                                            <p>Explore our range of <t t-esc="category.name"/> products.</p>
                                        </div>
                                        <div class="mt-3">
                                            <small class="text-muted">
                                                <i class="fa fa-cube"></i>
                                                <t t-esc="category.product_count"/> Products in this category
                                            </small>
                                        </div>
                                    </div>
                                    <div class="col-md-6 text-center">
                                        <t t-if="category.image_1920">
                                            <img t-attf-src="data:image/png;base64,{{category.image_1920}}"
                                                 class="img-fluid rounded category-image"
                                                 t-att-alt="category.name"
                                                 loading="lazy"/>
                                        </t>
                                        <t t-else="">
                                            <div class="placeholder-image">
                                                <i class="fa fa-image fa-5x text-muted"></i>
                                                <p class="text-muted mt-2">No image available</p>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </div>

                    <!-- Inline Styles -->
                    <style>
                        .cat-btn {
                            background: #f1f3f5;
                            border: none;
                            padding: 10px 18px;
                            border-radius: 20px;
                            font-weight: 600;
                            cursor: pointer;
                            transition: all 0.25s ease;
                            margin: 5px;
                        }
                        .cat-btn:hover, .cat-btn.active {
                            background: #007bff;
                            color: #fff;
                        }
                        .cat-panel {
                            display: none;
                            background: #f8f9fa;
                            padding: 30px;
                            border-radius: 16px;
                            box-shadow: 0 6px 20px rgba(0,0,0,0.05);
                            animation: fadeIn 0.3s ease-in;
                        }
                        .cat-panel.active {
                            display: block;
                        }
                        .category-image {
                            max-height: 400px;
                            object-fit: contain;
                        }
                        .placeholder-image {
                            background: #e9ecef;
                            padding: 60px 20px;
                            border-radius: 12px;
                        }
                        .category-description {
                            line-height: 1.6;
                        }
                        @keyframes fadeIn {
                            from { opacity: 0; transform: translateY(10px); }
                            to { opacity: 1; transform: translateY(0); }
                        }
                    </style>

                    <!-- Inline JavaScript -->
                    <script type="text/javascript">
                        (function() {
                            'use strict';

                            function showCategory(categoryId) {
                                // Remove active class from all panels and buttons
                                document.querySelectorAll('.cat-panel').forEach(function(p) {
                                    p.classList.remove('active');
                                });
                                document.querySelectorAll('.cat-btn').forEach(function(b) {
                                    b.classList.remove('active');
                                });

                                // Add active class to selected panel
                                var panel = document.getElementById('cat-' + categoryId);
                                if (panel) {
                                    panel.classList.add('active');
                                }

                                // Add active class to clicked button
                                var buttons = document.querySelectorAll('.cat-btn');
                                buttons.forEach(function(btn) {
                                    if (btn.getAttribute('data-category-id') == categoryId) {
                                        btn.classList.add('active');
                                    }
                                });
                            }

                            // Initialize category buttons
                            document.addEventListener('DOMContentLoaded', function() {
                                var buttons = document.querySelectorAll('.cat-btn');
                                buttons.forEach(function(btn) {
                                    btn.addEventListener('click', function() {
                                        var categoryId = this.getAttribute('data-category-id');
                                        showCategory(categoryId);
                                    });
                                });

                                // Show first category by default
                                if (buttons.length > 0) {
                                    var firstCategoryId = buttons[0].getAttribute('data-category-id');
                                    showCategory(firstCategoryId);
                                }
                            });
                        })();
                    </script>
                </div>
            </t>
        </template>

    </data>
</odoo>