<odoo>
    <!-- Create Parent Menu for Partner Reports -->
    <menuitem id="menu_finance_partner_reports"
              name="Partner Reports"
              parent="account.menu_finance_reports"
              sequence="50"/>

    <!-- INHERIT the Odoo Mates base view and add Show Details button -->
    <record id="account_aged_balance_view_inherit" model="ir.ui.view">
        <field name="name">Aged Partner Balance - Add Show Details</field>
        <field name="model">account.aged.trial.balance</field>
        <field name="inherit_id" ref="accounting_pdf_reports.account_aged_balance_view"/>
        <field name="arch" type="xml">
            <!-- Add Show Details button before Print button -->
            <xpath expr="//footer/button[@name='check_report']" position="before">
                <button name="show_details"
                        class="btn btn-primary"
                        string="Show Details"
                        type="object"/>
            </xpath>
        </field>
    </record>

    <!-- Detail Line Tree View -->
    <record id="view_aged_detail_tree" model="ir.ui.view">
        <field name="name">account.aged.detail.line.tree</field>
        <field name="model">account.aged.detail.line</field>
        <field name="arch" type="xml">
            <list string="Aged Balance Details"
                  decoration-danger="total &gt; 0 and (period_3 != 0 or period_4 != 0)"
                  decoration-warning="total &gt; 0 and (period_1 != 0 or period_2 != 0)"
                  decoration-info="total &lt; 0"
                  create="false" edit="false">

                <field name="partner_name" string="Partner"/>
                <field name="trust" optional="show"/>
                <field name="email" optional="hide"/>
                <field name="phone" optional="hide"/>
                <field name="vat" optional="hide"/>

                <field name="not_due"
                       sum="Total Not Due"
                       widget="monetary"
                       string="Not Due"/>

                <field name="period_0"
                       sum="Total"
                       widget="monetary"
                       string="0-30"/>

                <field name="period_1"
                       sum="Total"
                       widget="monetary"
                       decoration-warning="period_1 != 0"
                       string="31-60"/>

                <field name="period_2"
                       sum="Total"
                       widget="monetary"
                       decoration-warning="period_2 != 0"
                       string="61-90"/>

                <field name="period_3"
                       sum="Total"
                       widget="monetary"
                       decoration-danger="period_3 != 0"
                       string="91-120"/>

                <field name="period_4"
                       sum="Total"
                       widget="monetary"
                       decoration-danger="period_4 != 0"
                       string="120+"/>

                <field name="total"
                       sum="Grand Total"
                       widget="monetary"
                       decoration-bf="1"
                       string="Total"/>

                <button name="action_view_journal_entries"
                        type="object"
                        icon="fa-book"
                        title="View Journal Entries"/>
            </list>
        </field>
    </record>

    <!-- Detail Line Form View -->
    <record id="view_aged_detail_form" model="ir.ui.view">
        <field name="name">account.aged.detail.line.form</field>
        <field name="model">account.aged.detail.line</field>
        <field name="arch" type="xml">
            <form string="Aged Balance Detail">
                <sheet>
                    <group>
                        <group string="Partner Information">
                            <field name="partner_id" readonly="1"/>
                            <field name="partner_name" readonly="1"/>
                            <field name="trust" readonly="1"/>
                            <field name="email" readonly="1"/>
                            <field name="phone" readonly="1"/>
                            <field name="vat" readonly="1"/>
                        </group>
                        <group string="Aging Breakdown">
                            <field name="not_due" readonly="1" widget="monetary"/>
                            <field name="period_0" readonly="1" widget="monetary"/>
                            <field name="period_1" readonly="1" widget="monetary"/>
                            <field name="period_2" readonly="1" widget="monetary"/>
                            <field name="period_3" readonly="1" widget="monetary"/>
                            <field name="period_4" readonly="1" widget="monetary"/>
                            <field name="total" readonly="1" widget="monetary"/>
                        </group>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <button name="action_view_journal_entries"
                            type="object"
                            class="oe_highlight"
                            string="View Journal Entries"/>
                </div>
            </form>
        </field>
    </record>

    <!-- Action for Aged Detail Lines -->
    <record id="action_aged_detail_lines" model="ir.actions.act_window">
        <field name="name">Aged Balance Details</field>
        <field name="res_model">account.aged.detail.line</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_aged_detail_tree"/>
        <field name="target">current</field>
    </record>

    <!-- Update existing menu items to use our parent menu -->
    <record id="accounting_pdf_reports.menu_aged_trial_balance" model="ir.ui.menu">
        <field name="parent_id" ref="menu_finance_partner_reports"/>
    </record>

    <record id="accounting_pdf_reports.menu_aged_receivable" model="ir.ui.menu">
        <field name="parent_id" ref="menu_finance_partner_reports"/>
    </record>

    <record id="accounting_pdf_reports.menu_aged_payable" model="ir.ui.menu">
        <field name="parent_id" ref="menu_finance_partner_reports"/>
    </record>

</odoo>