<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_picking_form_inherit_flexible_transfer" model="ir.ui.view">
        <field name="name">stock.picking.form.inherit.flexible.transfer</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <!-- Add tracking fields -->
            <xpath expr="//field[@name='state']" position="before">
                <field name="is_inter_warehouse_transfer" invisible="1"/>
                <field name="auto_receipt_created" invisible="1"/>
                <field name="source_warehouse_id" invisible="1"/>
                <field name="dest_warehouse_id" invisible="1"/>
            </xpath>

            <!-- Add banner for inter-warehouse transfers -->
            <xpath expr="//sheet" position="before">
                <!-- Banner for outgoing requests -->
                <div class="alert alert-info text-center" role="alert"
                     invisible="not is_inter_warehouse_transfer or location_id.usage == 'transit' or state == 'done'">
                    <strong>ðŸ“¤ Inter-Warehouse Transfer Request</strong><br/>
                    From: <field name="source_warehouse_id" readonly="1" class="fw-bold"/> â†’
                    To: <field name="dest_warehouse_id" readonly="1" class="fw-bold"/><br/>
                    <span class="text-muted">Validate to approve this request and send products.</span>
                </div>

                <!-- Banner for incoming receipts -->
                <div class="alert alert-success text-center" role="alert"
                     invisible="not origin or location_id.usage != 'transit' or state == 'done'">
                    <strong>ðŸ“¥ Incoming Stock Receipt</strong><br/>
                    <span>This receipt was automatically created from transfer request.</span><br/>
                    <span class="text-muted">Validate to receive products into your warehouse.</span>
                </div>

                <!-- Success banner after validation -->
                <div class="alert alert-success text-center" role="alert"
                     invisible="not is_inter_warehouse_transfer or state != 'done' or location_id.usage == 'transit'">
                    <strong>âœ… Transfer Completed Successfully</strong><br/>
                    Receipt has been created for destination warehouse.
                </div>
            </xpath>

            <!-- Add warehouse info in header -->
            <xpath expr="//div[@name='button_box']" position="before">
                <div class="row" invisible="not is_inter_warehouse_transfer">
                    <div class="col-6">
                        <label for="source_warehouse_id" class="fw-bold">Source Warehouse</label>
                        <field name="source_warehouse_id" readonly="1"/>
                    </div>
                    <div class="col-6">
                        <label for="dest_warehouse_id" class="fw-bold">Destination Warehouse</label>
                        <field name="dest_warehouse_id" readonly="1"/>
                    </div>
                </div>
            </xpath>
        </field>
    </record>

    <!-- Add tree view indicator -->
    <record id="view_picking_tree_inherit_flexible_transfer" model="ir.ui.view">
        <field name="name">stock.picking.tree.inherit.flexible.transfer</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.vpicktree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='state']" position="before">
                <field name="is_inter_warehouse_transfer" optional="show" string="Inter-WH"/>
                <field name="source_warehouse_id" optional="show" string="From"/>
                <field name="dest_warehouse_id" optional="show" string="To"/>
            </xpath>
        </field>
    </record>
</odoo>