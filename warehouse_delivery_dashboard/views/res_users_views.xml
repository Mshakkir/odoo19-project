<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Add Warehouse Fields to User Form -->
    <record id="view_users_form_warehouse" model="ir.ui.view">
        <field name="name">res.users.form.warehouse</field>
        <field name="model">res.users</field>
        <field name="inherit_id" ref="base.view_users_form"/>
        <field name="arch" type="xml">
            <!-- Add Warehouse Tab -->
            <xpath expr="//notebook" position="inside">
                <page string="Warehouse Assignment" groups="stock.group_stock_manager">
                    <group>
                        <group string="Warehouse Configuration">
                            <field name="default_warehouse_id"
                                   options="{'no_create': True, 'no_open': True}"/>
                            <field name="warehouse_ids" widget="many2many_tags"
                                   options="{'no_create': True}"/>
                        </group>
                        <group string="Delivery Statistics">
                            <field name="pending_deliveries_count" readonly="1"/>
                            <field name="ready_deliveries_count" readonly="1"/>
                            <field name="urgent_deliveries_count" readonly="1"/>
                            <field name="today_deliveries_count" readonly="1"/>
                        </group>
                    </group>
                    <group>
                        <button name="action_view_my_pending_deliveries"
                                string="View My Deliveries"
                                type="object"
                                class="btn-primary"
                                icon="fa-truck"/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <!-- User Tree View with Warehouse Info -->
    <record id="view_users_tree_warehouse" model="ir.ui.view">
        <field name="name">res.users.tree.warehouse</field>
        <field name="model">res.users</field>
        <field name="inherit_id" ref="base.view_users_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='login']" position="after">
                <field name="default_warehouse_id" optional="show"/>
                <field name="pending_deliveries_count" optional="show"/>
            </xpath>
        </field>
    </record>

</odoo>