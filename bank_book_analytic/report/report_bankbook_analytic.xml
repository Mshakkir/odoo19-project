<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Main Report Template -->
    <template id="report_bankbook_analytic">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">
                <div class="page">
                    <h2>Bank Book Report</h2>

                    <div class="row mb-3">
                        <div class="col-6">
                            <strong>Date From:</strong>
                            <p t-esc="data.get('date_from')"/>
                        </div>
                        <div class="col-6">
                            <strong>Date To:</strong>
                            <p t-esc="data.get('date_to')"/>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-6">
                            <strong>Report Type:</strong>
                            <p t-esc="report_type == 'combined' and 'Combined Report' or 'Separate by Analytic Account'"/>
                        </div>
                        <div class="col-6">
                            <strong>Analytic Accounts:</strong>
                            <p>
                                <t t-if="analytic_accounts">
                                    <t t-foreach="analytic_accounts.items()" t-as="item">
                                        <span t-esc="item[1]"/><br/>
                                    </t>
                                </t>
                                <t t-else="">
                                    All Accounts
                                </t>
                            </p>
                        </div>
                    </div>

                    <!-- Combined Report -->
                    <t t-if="report_type == 'combined'">
                        <table class="table table-sm table-bordered mt-4">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Reference</th>
                                    <th>Description</th>
                                    <th>Journal</th>
                                    <th>Debit</th>
                                    <th>Credit</th>
                                    <th>Balance</th>
                                    <th>Analytic Account</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="Accounts" t-as="account">
                                    <tr class="table-active">
                                        <td colspan="8"><strong t-esc="account.get('code')"/> - <t t-esc="account.get('name')"/></td>
                                    </tr>
                                    <t t-foreach="account.get('move_lines', [])" t-as="line">
                                        <tr>
                                            <td t-esc="line.get('ldate')"/>
                                            <td t-esc="line.get('lref')"/>
                                            <td t-esc="line.get('lname')"/>
                                            <td t-esc="line.get('lcode')"/>
                                            <td class="text-right"><t t-esc="'{:,.2f}'.format(line.get('debit', 0))"/></td>
                                            <td class="text-right"><t t-esc="'{:,.2f}'.format(line.get('credit', 0))"/></td>
                                            <td class="text-right"><t t-esc="'{:,.2f}'.format(line.get('balance', 0))"/></td>
                                            <td t-esc="', '.join(line.get('analytic_account_names', []))"/>
                                        </tr>
                                    </t>
                                    <tr class="table-active">
                                        <td colspan="4"><strong>Total</strong></td>
                                        <td class="text-right"><strong t-esc="'{:,.2f}'.format(account.get('debit', 0))"/></td>
                                        <td class="text-right"><strong t-esc="'{:,.2f}'.format(account.get('credit', 0))"/></td>
                                        <td class="text-right"><strong t-esc="'{:,.2f}'.format(account.get('balance', 0))"/></td>
                                        <td></td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </t>

                    <!-- Separate by Analytic Report -->
                    <t t-if="report_type == 'separate'">
                        <t t-foreach="analytic_accounts.items()" t-as="analytic">
                            <h3 t-esc="analytic[1]" class="mt-4 mb-2"/>
                            <table class="table table-sm table-bordered">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Reference</th>
                                        <th>Description</th>
                                        <th>Journal</th>
                                        <th>Debit</th>
                                        <th>Credit</th>
                                        <th>Balance</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="analytic_groups.get(analytic[0], [])" t-as="account">
                                        <tr class="table-active">
                                            <td colspan="7"><strong t-esc="account.get('code')"/> - <t t-esc="account.get('name')"/></td>
                                        </tr>
                                        <t t-foreach="account.get('move_lines', [])" t-as="line">
                                            <tr>
                                                <td t-esc="line.get('ldate')"/>
                                                <td t-esc="line.get('lref')"/>
                                                <td t-esc="line.get('lname')"/>
                                                <td t-esc="line.get('lcode')"/>
                                                <td class="text-right"><t t-esc="'{:,.2f}'.format(line.get('debit', 0))"/></td>
                                                <td class="text-right"><t t-esc="'{:,.2f}'.format(line.get('credit', 0))"/></td>
                                                <td class="text-right"><t t-esc="'{:,.2f}'.format(line.get('balance', 0))"/></td>
                                            </tr>
                                        </t>
                                        <tr class="table-active">
                                            <td colspan="3"><strong>Total</strong></td>
                                            <td></td>
                                            <td class="text-right"><strong t-esc="'{:,.2f}'.format(account.get('debit', 0))"/></td>
                                            <td class="text-right"><strong t-esc="'{:,.2f}'.format(account.get('credit', 0))"/></td>
                                            <td class="text-right"><strong t-esc="'{:,.2f}'.format(account.get('balance', 0))"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </t>

                        <!-- Transactions without Analytic Account -->
                        <t t-if="show_without_analytic and without_analytic_data">
                            <h3 class="mt-4 mb-2">Transactions Without Analytic Account</h3>
                            <table class="table table-sm table-bordered">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Reference</th>
                                        <th>Description</th>
                                        <th>Journal</th>
                                        <th>Debit</th>
                                        <th>Credit</th>
                                        <th>Balance</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="without_analytic_data" t-as="account">
                                        <tr class="table-active">
                                            <td colspan="7"><strong t-esc="account.get('code')"/> - <t t-esc="account.get('name')"/></td>
                                        </tr>
                                        <t t-foreach="account.get('move_lines', [])" t-as="line">
                                            <tr>
                                                <td t-esc="line.get('ldate')"/>
                                                <td t-esc="line.get('lref')"/>
                                                <td t-esc="line.get('lname')"/>
                                                <td t-esc="line.get('lcode')"/>
                                                <td class="text-right"><t t-esc="'{:,.2f}'.format(line.get('debit', 0))"/></td>
                                                <td class="text-right"><t t-esc="'{:,.2f}'.format(line.get('credit', 0))"/></td>
                                                <td class="text-right"><t t-esc="'{:,.2f}'.format(line.get('balance', 0))"/></td>
                                            </tr>
                                        </t>
                                        <tr class="table-active">
                                            <td colspan="3"><strong>Total</strong></td>
                                            <td></td>
                                            <td class="text-right"><strong t-esc="'{:,.2f}'.format(account.get('debit', 0))"/></td>
                                            <td class="text-right"><strong t-esc="'{:,.2f}'.format(account.get('credit', 0))"/></td>
                                            <td class="text-right"><strong t-esc="'{:,.2f}'.format(account.get('balance', 0))"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </t>
                    </t>

                </div>
            </t>
        </t>
    </template>

</odoo>







<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->

<!--    <template id="report_bank_analytic_inherit" inherit_id="om_account_daily_reports.report_bankbook">-->

<!--        &lt;!&ndash; Add Analytic Account information in the header section &ndash;&gt;-->
<!--        <xpath expr="//div[@class='col-2'][last()]" position="after">-->
<!--            <div class="col-4">-->
<!--                <strong>Analytic Accounts:</strong>-->
<!--                <p t-esc="analytic_accounts"/>-->
<!--            </div>-->
<!--        </xpath>-->

<!--    </template>-->

<!--</odoo>-->