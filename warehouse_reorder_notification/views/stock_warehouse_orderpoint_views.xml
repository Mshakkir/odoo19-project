<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Warehouse Form View - Add notification settings -->
    <record id="view_warehouse_form_inherit_notification" model="ir.ui.view">
        <field name="name">stock.warehouse.form.inherit.notification</field>
        <field name="model">stock.warehouse</field>
        <field name="inherit_id" ref="stock.view_warehouse"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='warehouse_config']" position="after">
                <page string="Reorder Notifications" groups="stock.group_stock_manager">
                    <group>
                        <group>
                            <field name="enable_reorder_notifications"/>
                        </group>
                    </group>
                    <group string="Notification Recipients" invisible="not enable_reorder_notifications">
                        <field name="notification_user_ids" widget="many2many_tags" nolabel="1"/>
                    </group>
                    <div class="alert alert-info" role="alert" invisible="not enable_reorder_notifications">
                        <p><strong>‚ÑπÔ∏è How it works:</strong></p>
                        <ul>
                            <li>Notifications appear in the bell/clock icon (üîî) at the top of Odoo</li>
                            <li>Users listed above will receive reorder alerts</li>
                            <li>If no users specified, all inventory users will be notified</li>
                            <li><strong>IMPORTANT: Only assigned users can see reorder rules for this warehouse</strong></li>
                            <li>Automatic checks run every hour</li>
                            <li>Notifications auto-close when stock is replenished</li>
                            <li>Manual notifications can be triggered from reordering rules</li>
                        </ul>
                    </div>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Add Search View with Filters -->
    <record id="view_warehouse_orderpoint_search_inherit" model="ir.ui.view">
        <field name="name">stock.warehouse.orderpoint.search.inherit.notification</field>
        <field name="model">stock.warehouse.orderpoint</field>
        <field name="inherit_id" ref="stock.stock_warehouse_orderpoint_search"/>
        <field name="arch" type="xml">
            <xpath expr="//search" position="inside">
                <!-- Add filters for stock status -->
                <separator/>
                <filter string="üî¥ Below Minimum" name="below_minimum"
                        domain="[('stock_status', '=', 'below_min')]"/>
                <filter string="üü° Above Maximum" name="above_maximum"
                        domain="[('stock_status', '=', 'above_max')]"/>
                <filter string="‚úÖ Stock OK" name="stock_ok"
                        domain="[('stock_status', '=', 'ok')]"/>
                <separator/>
                <filter string="üì¢ Has Active Notifications" name="has_notifications"
                        domain="[('has_active_notification', '=', True)]"/>
                <filter string="Hide Stock OK" name="hide_stock_ok"
                        domain="[('stock_status', '!=', 'ok')]"/>
            </xpath>
        </field>
    </record>

    <!-- Update Action to show only problematic stock by default -->
    <record id="stock.action_orderpoint_tree" model="ir.actions.act_window">
        <field name="context">{'search_default_hide_stock_ok': 1}</field>
    </record>

    <!-- Reordering Rule Form - Add notification features -->
    <record id="view_warehouse_orderpoint_form_inherit" model="ir.ui.view">
        <field name="name">stock.warehouse.orderpoint.form.inherit.notification</field>
        <field name="model">stock.warehouse.orderpoint</field>
        <field name="inherit_id" ref="stock.view_warehouse_orderpoint_form"/>
        <field name="arch" type="xml">
            <!-- Add buttons inside the sheet -->
            <xpath expr="//sheet" position="inside">
                <div class="oe_button_box" name="button_box">
                    <button name="action_send_notification_now"
                            string="Send Notification"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-bell"
                            groups="stock.group_stock_user"/>
                    <button name="action_close_notification"
                            string="Close Notification"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-check-circle"
                            groups="stock.group_stock_user"
                            invisible="not has_active_notification"/>
                    <button name="action_view_notifications"
                            string="View Notifications"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-list"
                            groups="stock.group_stock_user"
                            invisible="notification_count == 0">
                        <field name="notification_count" widget="statinfo" string="Notifications"/>
                    </button>
                </div>
            </xpath>

            <!-- Add notification fields -->
            <xpath expr="//field[@name='product_max_qty']" position="after">
                <field name="stock_status" widget="badge"
                       decoration-success="stock_status == 'ok'"
                       decoration-danger="stock_status == 'below_min'"
                       decoration-warning="stock_status == 'above_max'"/>
                <field name="last_notification_date" readonly="1"/>
                <field name="has_active_notification" invisible="1"/>
            </xpath>
        </field>
    </record>

    <!-- Scheduled Action - Check reorder rules every hour -->
    <record id="ir_cron_check_reorder_notifications" model="ir.cron">
        <field name="name">Warehouse: Check Reordering Rules and Send Notifications</field>
        <field name="model_id" ref="stock.model_stock_warehouse_orderpoint"/>
        <field name="state">code</field>
        <field name="code">model.check_and_send_reorder_notifications()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">hours</field>
        <field name="active" eval="True"/>
    </record>
</odoo>








<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->
<!--    &lt;!&ndash; Warehouse Form View - Add notification settings &ndash;&gt;-->
<!--    <record id="view_warehouse_form_inherit_notification" model="ir.ui.view">-->
<!--        <field name="name">stock.warehouse.form.inherit.notification</field>-->
<!--        <field name="model">stock.warehouse</field>-->
<!--        <field name="inherit_id" ref="stock.view_warehouse"/>-->
<!--        <field name="arch" type="xml">-->
<!--            <xpath expr="//page[@name='warehouse_config']" position="after">-->
<!--                <page string="Reorder Notifications" groups="stock.group_stock_manager">-->
<!--                    <group>-->
<!--                        <group>-->
<!--                            <field name="enable_reorder_notifications"/>-->
<!--                        </group>-->
<!--                    </group>-->
<!--                    <group string="Notification Recipients" invisible="not enable_reorder_notifications">-->
<!--                        <field name="notification_user_ids" widget="many2many_tags" nolabel="1"/>-->
<!--                    </group>-->
<!--                    <div class="alert alert-info" role="alert" invisible="not enable_reorder_notifications">-->
<!--                        <p><strong>‚ÑπÔ∏è How it works:</strong></p>-->
<!--                        <ul>-->
<!--                            <li>Notifications appear in the bell/clock icon (üîî) at the top of Odoo</li>-->
<!--                            <li>Users listed above will receive reorder alerts</li>-->
<!--                            <li>If no users specified, all inventory users will be notified</li>-->
<!--                            <li><strong>IMPORTANT: Only assigned users can see reorder rules for this warehouse</strong></li>-->
<!--                            <li>Automatic checks run every hour</li>-->
<!--                            <li>Notifications auto-close when stock is replenished</li>-->
<!--                            <li>Manual notifications can be triggered from reordering rules</li>-->
<!--                        </ul>-->
<!--                    </div>-->
<!--                </page>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Reordering Rule Tree View - Add filters and status &ndash;&gt;-->
<!--    <record id="view_warehouse_orderpoint_tree_inherit" model="ir.ui.view">-->
<!--        <field name="name">stock.warehouse.orderpoint.tree.inherit.notification</field>-->
<!--        <field name="model">stock.warehouse.orderpoint</field>-->
<!--        <field name="inherit_id" ref="stock.view_warehouse_orderpoint_tree"/>-->
<!--        <field name="arch" type="xml">-->
<!--            &lt;!&ndash; Add stock status column &ndash;&gt;-->
<!--            <xpath expr="//field[@name='product_id']" position="after">-->
<!--                <field name="stock_status" widget="badge"-->
<!--                       decoration-success="stock_status == 'ok'"-->
<!--                       decoration-danger="stock_status == 'below_min'"-->
<!--                       decoration-warning="stock_status == 'above_max'"/>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Add Search View with Filters &ndash;&gt;-->
<!--    <record id="view_warehouse_orderpoint_search_inherit" model="ir.ui.view">-->
<!--        <field name="name">stock.warehouse.orderpoint.search.inherit.notification</field>-->
<!--        <field name="model">stock.warehouse.orderpoint</field>-->
<!--        <field name="inherit_id" ref="stock.stock_warehouse_orderpoint_search"/>-->
<!--        <field name="arch" type="xml">-->
<!--            <xpath expr="//search" position="inside">-->
<!--                &lt;!&ndash; Add filters for stock status &ndash;&gt;-->
<!--                <filter string="üî¥ Below Minimum" name="below_minimum"-->
<!--                        domain="[('stock_status', '=', 'below_min')]"/>-->
<!--                <filter string="üü° Above Maximum" name="above_maximum"-->
<!--                        domain="[('stock_status', '=', 'above_max')]"/>-->
<!--                <filter string="‚úÖ Stock OK" name="stock_ok"-->
<!--                        domain="[('stock_status', '=', 'ok')]"/>-->
<!--                <separator/>-->
<!--                <filter string="üì¢ Has Active Notifications" name="has_notifications"-->
<!--                        domain="[('has_active_notification', '=', True)]"/>-->
<!--                <filter string="Hide Stock OK" name="hide_stock_ok"-->
<!--                        domain="[('stock_status', '!=', 'ok')]"/>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Update Action to show only problematic stock by default &ndash;&gt;-->
<!--    <record id="stock.action_orderpoint_tree" model="ir.actions.act_window">-->
<!--        <field name="context">{'search_default_hide_stock_ok': 1}</field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Reordering Rule Form - Add notification features &ndash;&gt;-->
<!--    <record id="view_warehouse_orderpoint_form_inherit" model="ir.ui.view">-->
<!--        <field name="name">stock.warehouse.orderpoint.form.inherit.notification</field>-->
<!--        <field name="model">stock.warehouse.orderpoint</field>-->
<!--        <field name="inherit_id" ref="stock.view_warehouse_orderpoint_form"/>-->
<!--        <field name="arch" type="xml">-->
<!--            &lt;!&ndash; Add buttons inside the sheet &ndash;&gt;-->
<!--            <xpath expr="//sheet" position="inside">-->
<!--                <div class="oe_button_box" name="button_box">-->
<!--                    <button name="action_send_notification_now"-->
<!--                            string="Send Notification"-->
<!--                            type="object"-->
<!--                            class="oe_stat_button"-->
<!--                            icon="fa-bell"-->
<!--                            groups="stock.group_stock_user"/>-->
<!--                    <button name="action_close_notification"-->
<!--                            string="Close Notification"-->
<!--                            type="object"-->
<!--                            class="oe_stat_button"-->
<!--                            icon="fa-check-circle"-->
<!--                            groups="stock.group_stock_user"-->
<!--                            invisible="not has_active_notification"/>-->
<!--                    <button name="action_view_notifications"-->
<!--                            string="View Notifications"-->
<!--                            type="object"-->
<!--                            class="oe_stat_button"-->
<!--                            icon="fa-list"-->
<!--                            groups="stock.group_stock_user"-->
<!--                            invisible="notification_count == 0">-->
<!--                        <field name="notification_count" widget="statinfo" string="Notifications"/>-->
<!--                    </button>-->
<!--                </div>-->
<!--            </xpath>-->

<!--            &lt;!&ndash; Add notification fields &ndash;&gt;-->
<!--            <xpath expr="//field[@name='product_max_qty']" position="after">-->
<!--                <field name="stock_status" widget="badge"-->
<!--                       decoration-success="stock_status == 'ok'"-->
<!--                       decoration-danger="stock_status == 'below_min'"-->
<!--                       decoration-warning="stock_status == 'above_max'"/>-->
<!--                <field name="last_notification_date" readonly="1"/>-->
<!--                <field name="has_active_notification" invisible="1"/>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Scheduled Action - Check reorder rules every hour &ndash;&gt;-->
<!--    <record id="ir_cron_check_reorder_notifications" model="ir.cron">-->
<!--        <field name="name">Warehouse: Check Reordering Rules and Send Notifications</field>-->
<!--        <field name="model_id" ref="stock.model_stock_warehouse_orderpoint"/>-->
<!--        <field name="state">code</field>-->
<!--        <field name="code">model.check_and_send_reorder_notifications()</field>-->
<!--        <field name="interval_number">1</field>-->
<!--        <field name="interval_type">hours</field>-->
<!--        <field name="active" eval="True"/>-->
<!--    </record>-->
<!--</odoo>-->









<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->
<!--    &lt;!&ndash; Warehouse Form View - Add notification settings &ndash;&gt;-->
<!--    <record id="view_warehouse_form_inherit_notification" model="ir.ui.view">-->
<!--        <field name="name">stock.warehouse.form.inherit.notification</field>-->
<!--        <field name="model">stock.warehouse</field>-->
<!--        <field name="inherit_id" ref="stock.view_warehouse"/>-->
<!--        <field name="arch" type="xml">-->
<!--            <xpath expr="//page[@name='warehouse_config']" position="after">-->
<!--                <page string="Reorder Notifications" groups="stock.group_stock_manager">-->
<!--                    <group>-->
<!--                        <group>-->
<!--                            <field name="enable_reorder_notifications"/>-->
<!--                        </group>-->
<!--                    </group>-->
<!--                    <group string="Notification Recipients" invisible="not enable_reorder_notifications">-->
<!--                        <field name="notification_user_ids" widget="many2many_tags" nolabel="1"/>-->
<!--                    </group>-->
<!--                    <div class="alert alert-info" role="alert" invisible="not enable_reorder_notifications">-->
<!--                        <p><strong>‚ÑπÔ∏è How it works:</strong></p>-->
<!--                        <ul>-->
<!--                            <li>Notifications appear in the bell/clock icon (üîî) at the top of Odoo</li>-->
<!--                            <li>Users listed above will receive reorder alerts</li>-->
<!--                            <li>If no users specified, all inventory users will be notified</li>-->
<!--                            <li><strong>IMPORTANT: Only assigned users can see reorder rules for this warehouse</strong></li>-->
<!--                            <li>Automatic checks run every hour</li>-->
<!--                            <li>Notifications auto-close when stock is replenished</li>-->
<!--                            <li>Manual notifications can be triggered from reordering rules</li>-->
<!--                        </ul>-->
<!--                    </div>-->
<!--                </page>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Reordering Rule Form - Add notification features &ndash;&gt;-->
<!--    <record id="view_warehouse_orderpoint_form_inherit" model="ir.ui.view">-->
<!--        <field name="name">stock.warehouse.orderpoint.form.inherit.notification</field>-->
<!--        <field name="model">stock.warehouse.orderpoint</field>-->
<!--        <field name="inherit_id" ref="stock.view_warehouse_orderpoint_form"/>-->
<!--        <field name="arch" type="xml">-->
<!--            &lt;!&ndash; Add buttons inside the sheet &ndash;&gt;-->
<!--            <xpath expr="//sheet" position="inside">-->
<!--                <div class="oe_button_box" name="button_box">-->
<!--                    <button name="action_send_notification_now"-->
<!--                            string="Send Notification"-->
<!--                            type="object"-->
<!--                            class="oe_stat_button"-->
<!--                            icon="fa-bell"-->
<!--                            groups="stock.group_stock_user"/>-->
<!--                    <button name="action_close_notification"-->
<!--                            string="Close Notification"-->
<!--                            type="object"-->
<!--                            class="oe_stat_button"-->
<!--                            icon="fa-check-circle"-->
<!--                            groups="stock.group_stock_user"-->
<!--                            invisible="not has_active_notification"/>-->
<!--                    <button name="action_view_notifications"-->
<!--                            string="View Notifications"-->
<!--                            type="object"-->
<!--                            class="oe_stat_button"-->
<!--                            icon="fa-list"-->
<!--                            groups="stock.group_stock_user"-->
<!--                            invisible="notification_count == 0">-->
<!--                        <field name="notification_count" widget="statinfo" string="Notifications"/>-->
<!--                    </button>-->
<!--                </div>-->
<!--            </xpath>-->

<!--            &lt;!&ndash; Add notification fields &ndash;&gt;-->
<!--            <xpath expr="//field[@name='product_max_qty']" position="after">-->
<!--                <field name="last_notification_date" readonly="1"/>-->
<!--                <field name="has_active_notification" invisible="1"/>-->
<!--                <field name="stock_status" invisible="1"/>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Scheduled Action - Check reorder rules every hour &ndash;&gt;-->
<!--    <record id="ir_cron_check_reorder_notifications" model="ir.cron">-->
<!--        <field name="name">Warehouse: Check Reordering Rules and Send Notifications</field>-->
<!--        <field name="model_id" ref="stock.model_stock_warehouse_orderpoint"/>-->
<!--        <field name="state">code</field>-->
<!--        <field name="code">model.check_and_send_reorder_notifications()</field>-->
<!--        <field name="interval_number">1</field>-->
<!--        <field name="interval_type">hours</field>-->
<!--        <field name="active" eval="True"/>-->
<!--    </record>-->
<!--</odoo>-->











<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->
<!--    &lt;!&ndash; Warehouse Form View - Add notification settings &ndash;&gt;-->
<!--    <record id="view_warehouse_form_inherit_notification" model="ir.ui.view">-->
<!--        <field name="name">stock.warehouse.form.inherit.notification</field>-->
<!--        <field name="model">stock.warehouse</field>-->
<!--        <field name="inherit_id" ref="stock.view_warehouse"/>-->
<!--        <field name="arch" type="xml">-->
<!--            <xpath expr="//page[@name='warehouse_config']" position="after">-->
<!--                <page string="Reorder Notifications" groups="stock.group_stock_manager">-->
<!--                    <group>-->
<!--                        <group>-->
<!--                            <field name="enable_reorder_notifications"/>-->
<!--                        </group>-->
<!--                    </group>-->
<!--                    <group string="Notification Recipients" invisible="not enable_reorder_notifications">-->
<!--                        <field name="notification_user_ids" widget="many2many_tags" nolabel="1"/>-->
<!--                    </group>-->
<!--                    <div class="alert alert-info" role="alert" invisible="not enable_reorder_notifications">-->
<!--                        <p><strong>‚ÑπÔ∏è How it works:</strong></p>-->
<!--                        <ul>-->
<!--                            <li>Notifications appear in the bell/clock icon (üîî) at the top of Odoo</li>-->
<!--                            <li>Users listed above will receive reorder alerts</li>-->
<!--                            <li>If no users specified, all inventory users will be notified</li>-->
<!--                            <li><strong>IMPORTANT: Only assigned users can see reorder rules for this warehouse</strong></li>-->
<!--                            <li>Automatic checks run every 4 hours</li>-->
<!--                            <li>Manual notifications can be triggered from reordering rules</li>-->
<!--                        </ul>-->
<!--                    </div>-->
<!--                </page>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Reordering Rule Form - Add notification features &ndash;&gt;-->
<!--    <record id="view_warehouse_orderpoint_form_inherit" model="ir.ui.view">-->
<!--        <field name="name">stock.warehouse.orderpoint.form.inherit.notification</field>-->
<!--        <field name="model">stock.warehouse.orderpoint</field>-->
<!--        <field name="inherit_id" ref="stock.view_warehouse_orderpoint_form"/>-->
<!--        <field name="arch" type="xml">-->
<!--            &lt;!&ndash; Add buttons inside the sheet &ndash;&gt;-->
<!--            <xpath expr="//sheet" position="inside">-->
<!--                <div class="oe_button_box" name="button_box">-->
<!--                    <button name="action_send_notification_now"-->
<!--                            string="Send Notification"-->
<!--                            type="object"-->
<!--                            class="oe_stat_button"-->
<!--                            icon="fa-bell"-->
<!--                            groups="stock.group_stock_user"/>-->
<!--                    <button name="action_view_notifications"-->
<!--                            string="View Notifications"-->
<!--                            type="object"-->
<!--                            class="oe_stat_button"-->
<!--                            icon="fa-list"-->
<!--                            groups="stock.group_stock_user"-->
<!--                            invisible="notification_count == 0">-->
<!--                        <field name="notification_count" widget="statinfo" string="Notifications"/>-->
<!--                    </button>-->
<!--                </div>-->
<!--            </xpath>-->

<!--            &lt;!&ndash; Add notification fields &ndash;&gt;-->
<!--            <xpath expr="//field[@name='product_max_qty']" position="after">-->
<!--                <field name="last_notification_date" readonly="1"/>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Scheduled Action - Check reorder rules every 4 hours &ndash;&gt;-->
<!--    <record id="ir_cron_check_reorder_notifications" model="ir.cron">-->
<!--        <field name="name">Warehouse: Check Reordering Rules and Send Notifications</field>-->
<!--        <field name="model_id" ref="stock.model_stock_warehouse_orderpoint"/>-->
<!--        <field name="state">code</field>-->
<!--        <field name="code">model.check_and_send_reorder_notifications()</field>-->
<!--        <field name="interval_number">1</field>-->
<!--        <field name="interval_type">hours</field>-->
<!--        <field name="active" eval="True"/>-->
<!--    </record>-->
<!--</odoo>-->
