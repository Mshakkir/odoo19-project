<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="warehouse_reorder_notification.Dashboard">
        <div class="o_reorder_notification_dashboard">
            <div class="container-fluid">
                <!-- Header -->
                <div class="row mb-3">
                    <div class="col-12">
                        <div class="d-flex justify-content-between align-items-center">
                            <h2>Reorder Notifications Dashboard</h2>
                            <button class="btn btn-primary" t-on-click="refreshNotifications">
                                <i class="fa fa-refresh"/> Refresh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="row mb-4">
                    <div class="col-md-4">
                        <label>Warehouse:</label>
                        <select class="form-control" t-on-change="onWarehouseChange">
                            <option value="">All Warehouses</option>
                            <t t-foreach="state.warehouses" t-as="warehouse" t-key="warehouse.id">
                                <option t-att-value="warehouse.id"
                                        t-att-selected="state.selectedWarehouse === warehouse.id">
                                    <t t-esc="warehouse.name"/>
                                </option>
                            </t>
                        </select>
                    </div>
                </div>

                <!-- Statistics Cards -->
                <div class="row mb-4">
                    <div class="col-md-4">
                        <div class="card text-center cursor-pointer"
                             t-on-click="() => this.onFilterChange('all')"
                             t-att-class="state.filterType === 'all' ? 'border-primary' : ''">
                            <div class="card-body">
                                <h5 class="card-title">Total Notifications</h5>
                                <h2 class="text-primary" t-esc="state.counts.total"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center cursor-pointer"
                             t-on-click="() => this.onFilterChange('below_min')"
                             t-att-class="state.filterType === 'below_min' ? 'border-danger' : ''">
                            <div class="card-body">
                                <h5 class="card-title">Below Minimum</h5>
                                <h2 class="text-danger" t-esc="state.counts.below_min"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center cursor-pointer"
                             t-on-click="() => this.onFilterChange('above_max')"
                             t-att-class="state.filterType === 'above_max' ? 'border-warning' : ''">
                            <div class="card-body">
                                <h5 class="card-title">Above Maximum</h5>
                                <h2 class="text-warning" t-esc="state.counts.above_max"/>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Loading Spinner -->
                <div t-if="state.loading" class="text-center py-5">
                    <i class="fa fa-spinner fa-spin fa-3x"/>
                    <p class="mt-3">Loading notifications...</p>
                </div>

                <!-- Notifications List -->
                <div t-else="" class="row">
                    <div class="col-12">
                        <t t-if="filteredNotifications.length === 0">
                            <div class="alert alert-info text-center">
                                <i class="fa fa-check-circle fa-2x mb-2"/>
                                <p class="mb-0">No reordering notifications at this time!</p>
                            </div>
                        </t>
                        <t t-else="">
                            <t t-foreach="filteredNotifications" t-as="notification" t-key="notification.id">
                                <div class="alert mb-3"
                                     t-att-class="getNotificationClass(notification.notification_type)">
                                    <div class="d-flex align-items-start">
                                        <div class="flex-shrink-0">
                                            <i class="fa fa-3x"
                                               t-att-class="getNotificationIcon(notification.notification_type)"/>
                                        </div>
                                        <div class="flex-grow-1 ms-3">
                                            <h5 class="alert-heading">
                                                <span t-if="notification.product_code"
                                                      t-esc="'[' + notification.product_code + '] '"/>
                                                <t t-esc="notification.product_name"/>
                                            </h5>
                                            <p class="mb-2">
                                                <strong>Warehouse:</strong> <t t-esc="notification.warehouse_name"/> |
                                                <strong>Location:</strong> <t t-esc="notification.location_name"/>
                                            </p>
                                            <p class="mb-2" t-esc="notification.message"/>
                                            <div class="mt-2">
                                                <button class="btn btn-sm btn-outline-primary me-2"
                                                        t-on-click="() => this.openProduct(notification.product_id)">
                                                    <i class="fa fa-external-link"/> View Product
                                                </button>
                                                <button class="btn btn-sm btn-outline-secondary"
                                                        t-on-click="() => this.openReorderRule(notification.id)">
                                                    <i class="fa fa-cog"/> Edit Rule
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </t>
                        </t>
                    </div>
                </div>
            </div>
        </div>
    </t>
</templates>
