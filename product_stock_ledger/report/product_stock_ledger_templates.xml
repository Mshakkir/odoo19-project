<!-- product_stock_ledger/report/product_stock_ledger_templates.xml -->
<odoo>
  <template id="product_stock_ledger_report_layout">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="doc">
        <!-- empty to satisfy web.html_container -->
      </t>
      <div class="page">
        <div class="header">
          <div class="company_logo">
            <img t-att-src="'data:image/png;base64,%s' % (company.logo and company.logo.decode('utf-8') or '')" t-if="company.logo" style="max-height:60px"/>
          </div>
          <div class="company_info">
            <h2 t-esc="company.name"/>
            <div t-esc="company.partner_id.contact_address" />
          </div>
          <div class="report_title">
            <h3>Stock ledger [ Product wise ]</h3>
            <div>
              <span><strong>Between</strong></span>
              <span t-esc="data.get('date_from')"/> - <span t-esc="data.get('date_to')"/>
            </div>
          </div>
        </div>

        <div class="product_info">
          <table class="product_table">
            <tr>
              <td><strong>Product :</strong></td>
              <td><span t-esc="product.display_name"/></td>
            </tr>
            <tr>
              <td><strong>UoM :</strong></td>
              <td><span t-esc="product.uom_id.name"/></td>
            </tr>
          </table>
        </div>

        <table class="ledger_table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Voucher</th>
              <th>Particulars</th>
              <th>Type</th>
              <th>Rec. Qty</th>
              <th>Rate</th>
              <th>Issue Qty</th>
              <th>Rate</th>
              <th>Balance</th>
            </tr>
          </thead>
          <tbody>
            <t t-foreach="lines" t-as="l">
              <tr>
                <td><t t-esc="l['date']"/></td>
                <td><t t-esc="l['voucher']"/></td>
                <td><t t-esc="l['particulars']"/></td>
                <td><t t-esc="l['type']"/></td>
                <td class="num"><t t-esc="('%.2f' % l['rec_qty']) if l['rec_qty'] else ''"/></td>
                <td class="num"><t t-esc="('%.2f' % l['rec_rate']) if l['rec_rate'] else ''"/></td>
                <td class="num"><t t-esc="('%.2f' % l['issue_qty']) if l['issue_qty'] else ''"/></td>
                <td class="num"><t t-esc="('%.2f' % l['issue_rate']) if l['issue_rate'] else ''"/></td>
                <td class="num"><t t-esc="('%.2f' % l['balance'])"/></td>
              </tr>
            </t>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="4" style="text-align:right;"><strong>Sub Total</strong></td>
              <td class="num"><t t-esc="('%.2f' % total_rec)"/></td>
              <td></td>
              <td class="num"><t t-esc="('%.2f' % total_issue)"/></td>
              <td></td>
              <td class="num"><t t-esc="('%.2f' % (lines and lines[-1].get('balance',0.0) or 0.0))"/></td>
            </tr>
          </tfoot>
        </table>
      </div>
    </t>
  </template>

  <!-- Report wrapper for qweb-pdf -->
  <template id="product_stock_ledger_report">
    <t t-call="product_stock_ledger.product_stock_ledger_report_layout"/>
  </template>
</odoo>
