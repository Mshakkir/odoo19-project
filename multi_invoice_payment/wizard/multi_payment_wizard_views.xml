<notebook>
    <page string="Invoices to Pay" name="invoices_page">
        <!-- Show message when no invoices are loaded -->
        <div invisible="invoice_line_ids" class="alert alert-info" role="alert">
            <p><strong>No invoices loaded yet.</strong></p>
            <p>Please click the "Load Invoices" button above to fetch unpaid invoices for the selected customer.</p>
        </div>

        <!-- Show invoice lines when loaded -->
        <field name="invoice_line_ids" nolabel="1" invisible="not invoice_line_ids"/>

        <group class="oe_subtotal_footer oe_right" invisible="not invoice_line_ids">
            <field name="payment_amount"
                   string="Payment Amount"
                   widget="monetary"
                   options="{'currency_field': 'currency_id'}"
                   readonly="1"/>
            <field name="total_allocated"
                   string="Total Allocated"
                   widget="monetary"
                   options="{'currency_field': 'currency_id'}"
                   readonly="1"/>
            <field name="remaining_amount"
                   string="Remaining Amount"
                   widget="monetary"
                   options="{'currency_field': 'currency_id'}"
                   readonly="1"
                   class="oe_subtotal_footer_separator"/>
        </group>
    </page>

    <page string="Help" name="help_page">
        <group>
            <div class="alert alert-info" role="alert">
                <h4>How to Use:</h4>
                <ol>
                    <li><strong>Select Customer:</strong> Choose the customer who made the payment</li>
                    <li><strong>Enter Payment Amount:</strong> Enter the exact amount received (e.g., 2500 SAR)</li>
                    <li><strong>Click "Load Invoices":</strong> This will fetch all unpaid invoices for the customer and display them in the table</li>
                    <li><strong>Select Payment Journal:</strong> Choose your bank (e.g., SNB Bank)</li>
                    <li><strong>Select Invoices:</strong>
                        <ul>
                            <li>Enable "Auto Allocate" to automatically select and fill amounts for oldest invoices</li>
                            <li>OR manually check the "Pay" box and enter amounts for each invoice</li>
                            <li>Click OUTSIDE the row after entering amounts to save</li>
                        </ul>
                    </li>
                    <li><strong>Create Payment:</strong> Click "Create Payment" button</li>
                </ol>
                <h4>Tips:</h4>
                <ul>
                    <li>You MUST click "Load Invoices" button after selecting the customer</li>
                    <li>Use "Auto Allocate" for quick allocation to oldest invoices</li>
                    <li>You can partially pay multiple invoices</li>
                    <li>Total allocated cannot exceed payment amount</li>
                    <li>After entering an amount, click outside the row to save it</li>
                    <li><strong>Balance Amount:</strong> Shows the remaining amount due after subtracting what you're paying</li>
                    <li><strong>View Details:</strong> Click on "Total Invoiced Amount" to see all invoices or "Total Amount Received" to see payment history</li>
                </ul>
            </div>
        </group>
    </page>
</notebook>