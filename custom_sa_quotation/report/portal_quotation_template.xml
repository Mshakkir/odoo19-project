<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- =======================================================
         Custom Portal Sale Order Preview (Odoo 19 CE)
         - Hide default portal content
         - Show ONLY custom quotation
         - Hide header & footer in portal preview
         ======================================================= -->

    <template id="custom_portal_sale_order"
              inherit_id="sale.sale_order_portal_content"
              priority="100">

        <!-- =========================
             Hide default portal blocks
             ========================= -->

        <!-- Introduction -->
        <xpath expr="//div[@id='introduction']" position="attributes">
            <attribute name="style">display:none !important;</attribute>
        </xpath>

        <!-- Informations -->
        <xpath expr="//div[@id='informations']" position="attributes">
            <attribute name="style">display:none !important;</attribute>
        </xpath>

        <!-- Default order lines table -->
        <xpath expr="//div[@name='sol_table']" position="attributes">
            <attribute name="style">display:none !important;</attribute>
        </xpath>

        <!-- Totals -->
        <xpath expr="//div[@id='total']" position="attributes">
            <attribute name="style">display:none !important;</attribute>
        </xpath>

        <!-- Signature -->
        <xpath expr="//section[@id='signature']" position="attributes">
            <attribute name="style">display:none !important;</attribute>
        </xpath>

        <!-- Terms -->
        <xpath expr="//section[@id='terms']" position="attributes">
            <attribute name="style">display:none !important;</attribute>
        </xpath>

        <!-- =========================
             Add custom quotation
             ========================= -->

        <xpath expr="//div[@id='content']" position="before">

            <!-- Portal-only CSS -->
            <style>
                /* Hide ALL headers & footers ONLY in portal preview */
                body.o_portal_sale_order header,
                body.o_portal_sale_order footer,
                body.o_portal_sale_order .header,
                body.o_portal_sale_order .footer {
                    display: none !important;
                }

                /* Optional: remove extra spacing */
                body.o_portal_sale_order .page {
                    margin: 0 !important;
                    padding: 0 !important;
                }
            </style>

            <div class="custom-quotation-wrapper">

                <!-- Required variables -->
                <t t-set="o" t-value="sale_order"/>
                <t t-set="docs" t-value="[sale_order]"/>

                <!-- Call your custom Saudi quotation -->
                <t t-call="custom_sa_quotation.custom_saleorder_report"/>

            </div>

        </xpath>

    </template>

</odoo>
