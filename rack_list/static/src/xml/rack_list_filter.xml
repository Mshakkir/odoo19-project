<?xml version="1.0" encoding="utf-8"?>
<templates xml:space="preserve">

    <!-- ── Filter Bar Component ───────────────────────────────────────────── -->
    <t t-name="rack_list.FilterBar">
        <div class="rack_list_filter_bar">
            <input
                type="text"
                class="rack_filter_input o_input"
                placeholder="Product name or code"
                t-att-value="state.productFilter"
                t-on-input="onProductInput"
            />
            <select class="rack_filter_select o_input" t-on-change="onLocationChange">
                <option value="">Location</option>
                <t t-foreach="state.locations" t-as="loc" t-key="loc.id">
                    <option
                        t-att-value="loc.id"
                        t-att-selected="String(state.locationId) === String(loc.id)"
                    >
                        <t t-esc="loc.name"/>
                    </option>
                </t>
            </select>
            <button class="btn btn-primary" t-on-click="onApply">Apply</button>
            <button class="btn btn-secondary" t-on-click="onClear">Clear</button>
        </div>
    </t>

    <!--
        ── Rack List Controller Template ──────────────────────────────────────
        Primary inheritance from web.ListView.Controller.
        We insert <RackListFilterBar> before the <Layout> component,
        which is the outermost structural component in Odoo 17+ list views.

        Odoo 17/18/19 ListController template uses:
            <Layout ...>
                ...
                <t t-component="Renderer" .../>
                ...
            </Layout>

        We target <Layout> to prepend our filter bar before the whole view,
        outside the Layout so it's always visible above the control panel area.

        Actually, inserting INSIDE the outer div but BEFORE Layout puts it
        between the control panel and the list — exactly where we want it.
    -->
    <t t-name="rack_list.ListController"
       t-inherit="web.ListView.Controller"
       t-inherit-mode="primary">
        <xpath expr="//Layout" position="before">
            <RackListFilterBar
                applyFilters.bind="applyRackFilters"
                clearFilters.bind="clearRackFilters"
            />
        </xpath>
    </t>

</templates>