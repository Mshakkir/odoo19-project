<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_purchase_order_form_chatter_position" model="ir.ui.view">
        <field name="name">purchase.order.form.chatter.position</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//form" position="attributes">
                <attribute name="chatter_position">side</attribute>
            </xpath>
        </field>
    </record>

    <record id="view_purchase_order_form_custom_lines" model="ir.ui.view">
        <field name="name">purchase.order.form.custom.lines</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='order_line']/list" position="replace">
                <list string="Purchase Order Lines" editable="bottom" limit="200">
                    <control>
                        <create name="add_product_control" string="Add a product"/>
                    </control>

                    <field name="display_type" column_invisible="True"/>
                    <field name="currency_id" column_invisible="True"/>
                    <field name="sequence" column_invisible="True"/>
                    <field name="is_stock_low" column_invisible="True"/>

                    <field name="sequence_number" string="SN" readonly="1" width="35px"/>
                    <field name="product_code" string="P. Code" width="70px" readonly="1"/>

                    <field name="product_id"
                           string="Product"
                           readonly="state not in ['draft', 'sent']"
                           required="not display_type"
                           context="{'default_list_price': price_unit, 'default_uom_id': product_uom_id}"
                           options="{'show_label_warning': True}"
                           widget="many2one"
                           placeholder="Type to find a product..."/>

                    <field name="analytic_distribution"
                           string="Analytic"
                           widget="analytic_distribution"
                           options="{'product_field': 'product_id', 'business_domain': 'purchase_order', 'amount_field': 'price_subtotal'}"
                           groups="analytic.group_analytic_accounting"
                           width="60px"/>

                    <field name="product_qty"
                           string="Qty"
                           readonly="state not in ['draft', 'sent', 'purchase']"
                           width="45px"/>

                    <!-- RED  = stock not available -->
                    <button string=""
                            name="action_product_forecast_report"
                            type="object"
                            icon="fa-area-chart"
                            invisible="display_type or not is_stock_low"
                            class="text-danger"
                            width="20px"/>

                    <!-- GREEN = stock available -->
                    <button string=""
                            name="action_product_forecast_report"
                            type="object"
                            icon="fa-area-chart"
                            invisible="display_type or is_stock_low"
                            class="text-success"
                            width="20px"/>

                    <field name="qty_received"
                           string="Received"
                           column_invisible="parent.state != 'purchase'"
                           readonly="qty_received_method != 'manual'"
                           optional="hide"/>
                    <field name="qty_invoiced"
                           string="Billed"
                           column_invisible="parent.state != 'purchase'"
                           optional="hide"/>

                    <field name="product_uom_id"
                           string="Unit"
                           force_save="1"
                           readonly="state not in ['draft', 'sent']"
                           required="not display_type"
                           widget="many2one_uom"
                           groups="uom.group_uom"
                           options="{'no_open': True, 'no_create': True}"
                           width="50px"/>

                    <field name="price_unit"
                           string="Price"
                           readonly="state not in ['draft', 'sent']"
                           width="90px"/>

                    <field name="tax_ids"
                           string="Tax"
                           widget="many2many_tags"
                           options="{'no_create': True}"
                           context="{'active_test': True}"
                           readonly="state not in ['draft', 'sent']"
                           width="40px"/>

                    <field name="discount"
                           string="Disc%"
                           readonly="state not in ['draft', 'sent']"
                           width="70px"
                           groups="purchase.group_discount_per_po_line"/>

                    <field name="price_subtotal" string="Untax Amt" readonly="1" width="100px"/>
                    <field name="tax_amount"     string="Tax Value"  readonly="1" width="90px"/>
                    <field name="price_total"    string="Total"      readonly="1" width="110px"/>

                    <field name="date_planned" string="Expected Arrival" optional="hide" invisible="1"/>
                    <field name="propagate_cancel" string="Propagate Cancellation" optional="hide" invisible="1"/>
                    <field name="name" widget="text" optional="hide" invisible="1"/>
                </list>
            </xpath>
        </field>
    </record>
</odoo>



<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->
<!--    <record id="view_purchase_order_form_chatter_position" model="ir.ui.view">-->
<!--        <field name="name">purchase.order.form.chatter.position</field>-->
<!--        <field name="model">purchase.order</field>-->
<!--        <field name="inherit_id" ref="purchase.purchase_order_form"/>-->
<!--        <field name="arch" type="xml">-->
<!--            <xpath expr="//form" position="attributes">-->
<!--                <attribute name="chatter_position">side</attribute>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->

<!--    <record id="view_purchase_order_form_custom_lines" model="ir.ui.view">-->
<!--        <field name="name">purchase.order.form.custom.lines</field>-->
<!--        <field name="model">purchase.order</field>-->
<!--        <field name="inherit_id" ref="purchase.purchase_order_form"/>-->
<!--        <field name="arch" type="xml">-->
<!--            <xpath expr="//field[@name='order_line']/list" position="replace">-->
<!--                <list string="Purchase Order Lines" editable="bottom" limit="200">-->
<!--                    <control>-->
<!--                        <create name="add_product_control" string="Add a product"/>-->
<!--                    </control>-->

<!--                    <field name="display_type" column_invisible="True"/>-->
<!--                    <field name="currency_id" column_invisible="True"/>-->
<!--                    <field name="sequence" column_invisible="True"/>-->
<!--                    <field name="is_stock_low" column_invisible="True"/>-->

<!--                    <field name="sequence_number" string="SN" readonly="1" width="35px"/>-->

<!--                    <field name="product_code" string="P. Code" width="70px" readonly="1"/>-->

<!--                    <field name="product_id"-->
<!--                           string="Product"-->
<!--                           readonly="state not in ['draft', 'sent']"-->
<!--                           required="not display_type"-->
<!--                           context="{'default_list_price': price_unit, 'default_uom_id': product_uom_id}"-->
<!--                           options="{'show_label_warning': True}"-->
<!--                           widget="many2one"-->
<!--                           placeholder="Type to find a product..."/>-->

<!--                    <field name="analytic_distribution"-->
<!--                           string="Analytic"-->
<!--                           widget="analytic_distribution"-->
<!--                           options="{'product_field': 'product_id', 'business_domain': 'purchase_order', 'amount_field': 'price_subtotal'}"-->
<!--                           groups="analytic.group_analytic_accounting"-->
<!--                           width="60px"/>-->

<!--                    <field name="product_qty"-->
<!--                           string="Qty"-->
<!--                           readonly="state not in ['draft', 'sent', 'purchase']"-->
<!--                           width="45px"/>-->

<!--                    <button string=""-->
<!--                            name="action_product_forecast_report"-->
<!--                            type="object"-->
<!--                            icon="fa-area-chart"-->
<!--                            invisible="display_type"-->
<!--                            class="text-danger"-->
<!--                            attrs="{'invisible': [('is_stock_low', '=', False)]}"-->
<!--                            width="20px"/>-->

<!--                    <button string=""-->
<!--                            name="action_product_forecast_report"-->
<!--                            type="object"-->
<!--                            icon="fa-area-chart"-->
<!--                            invisible="display_type"-->
<!--                            attrs="{'invisible': [('is_stock_low', '=', True)]}"-->
<!--                            width="20px"/>-->

<!--                    <field name="qty_received"-->
<!--                           string="Received"-->
<!--                           column_invisible="parent.state != 'purchase'"-->
<!--                           readonly="qty_received_method != 'manual'"-->
<!--                           optional="hide"/>-->
<!--                    <field name="qty_invoiced"-->
<!--                           string="Billed"-->
<!--                           column_invisible="parent.state != 'purchase'"-->
<!--                           optional="hide"/>-->

<!--                    <field name="product_uom_id"-->
<!--                           string="Unit"-->
<!--                           force_save="1"-->
<!--                           readonly="state not in ['draft', 'sent']"-->
<!--                           required="not display_type"-->
<!--                           widget="many2one_uom"-->
<!--                           groups="uom.group_uom"-->
<!--                           options="{'no_open': True, 'no_create': True}"-->
<!--                           width="50px"/>-->

<!--                    <field name="price_unit"-->
<!--                           string="Price"-->
<!--                           readonly="state not in ['draft', 'sent']"-->
<!--                           width="90px"/>-->

<!--                    <field name="tax_ids"-->
<!--                           string="Tax"-->
<!--                           widget="many2many_tags"-->
<!--                           options="{'no_create': True}"-->
<!--                           context="{'active_test': True}"-->
<!--                           readonly="state not in ['draft', 'sent']"-->
<!--                           width="40px"/>-->

<!--                    <field name="discount"-->
<!--                           string="Disc%"-->
<!--                           readonly="state not in ['draft', 'sent']"-->
<!--                           width="70px"-->
<!--                           groups="purchase.group_discount_per_po_line"/>-->

<!--                    <field name="price_subtotal"-->
<!--                           string="Untax Amt"-->
<!--                           readonly="1"-->
<!--                           width="100px"/>-->

<!--                    <field name="tax_amount"-->
<!--                           string="Tax Value"-->
<!--                           readonly="1"-->
<!--                           width="90px"/>-->

<!--                    <field name="price_total"-->
<!--                           string="Total"-->
<!--                           readonly="1"-->
<!--                           width="110px"/>-->

<!--&lt;!&ndash;                    <field name="warehouse_id" string="Warehouse" optional="hide" invisible="1"/>&ndash;&gt;-->
<!--                    <field name="date_planned" string="Expected Arrival" optional="hide" invisible="1"/>-->
<!--                    <field name="propagate_cancel" string="Propagate Cancellation" optional="hide" invisible="1"/>-->
<!--                    <field name="name" widget="text" optional="hide" invisible="1"/>-->
<!--                </list>-->
<!--            </xpath>-->
<!--        </field>-->
<!--    </record>-->
<!--</odoo>-->


