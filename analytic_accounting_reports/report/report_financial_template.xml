<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_financial_inherit" inherit_id="accounting_pdf_reports.report_financial">

        <!-- Add warehouse selection info after the date range -->
        <xpath expr="//div[@class='row mt32 mb32']" position="after">
            <div class="row mb16" t-if="warehouse_display">
                <div class="col-12">
                    <strong>Warehouse Selection: </strong>
                    <span t-esc="warehouse_display"/>
                </div>
            </div>
        </xpath>

        <!-- Replace the report lines section to handle multiple warehouses -->
        <xpath expr="//t[@t-call='accounting_pdf_reports.report_financial_lines']" position="replace">

            <!-- Single warehouse or all warehouses combined mode -->
            <t t-if="not show_warehouse_breakdown">
                <t t-call="accounting_pdf_reports.report_financial_lines"/>
            </t>

            <!-- Multiple warehouses - show each separately -->
            <t t-if="show_warehouse_breakdown">
                <t t-foreach="warehouse_reports" t-as="warehouse_report">
                    <div class="warehouse-section" style="page-break-before: always; margin-top: 30px;">
                        <h3 style="background-color: #f0f0f0; padding: 10px; margin-bottom: 20px; border-left: 4px solid #875a7b;">
                            <strong>Warehouse: </strong>
                            <span t-esc="warehouse_report['warehouse_name']"/>
                        </h3>

                        <!-- Set warehouse-specific variables for this iteration -->
                        <t t-set="account_report_id" t-value="warehouse_report['report_data'].get('account_report_id')"/>
                        <t t-set="Accounts" t-value="warehouse_report['report_data'].get('Accounts')"/>
                        <t t-set="print_journal" t-value="warehouse_report['report_data'].get('print_journal')"/>
                        <t t-set="currency" t-value="warehouse_report['report_data'].get('currency')"/>

                        <t t-call="accounting_pdf_reports.report_financial_lines"/>
                    </div>
                </t>

                <!-- Combined report if requested -->
                <t t-if="include_combined and combined_report_data">
                    <div class="warehouse-section" style="page-break-before: always; margin-top: 30px;">
                        <h3 style="background-color: #d4edda; padding: 10px; margin-bottom: 20px; border-left: 4px solid #28a745;">
                            <strong>COMBINED REPORT - All Selected Warehouses</strong>
                        </h3>

                        <!-- Set combined report variables -->
                        <t t-set="account_report_id" t-value="combined_report_data.get('account_report_id')"/>
                        <t t-set="Accounts" t-value="combined_report_data.get('Accounts')"/>
                        <t t-set="print_journal" t-value="combined_report_data.get('print_journal')"/>
                        <t t-set="currency" t-value="combined_report_data.get('currency')"/>

                        <t t-call="accounting_pdf_reports.report_financial_lines"/>
                    </div>
                </t>
            </t>
        </xpath>
    </template>
</odoo>










<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->
<!--    <template id="report_financial_inherit" inherit_id="accounting_pdf_reports.report_financial">-->
<!--        <xpath expr="//div[@class='row mt32 mb32']" position="after">-->
<!--            <div class="row mb16" t-if="warehouse_display">-->
<!--                <div class="col-12">-->
<!--                    <strong>Warehouse Selection: </strong>-->
<!--                    <span t-esc="warehouse_display"/>-->
<!--                </div>-->
<!--            </div>-->
<!--        </xpath>-->
<!--    </template>-->
<!--</odoo>-->
