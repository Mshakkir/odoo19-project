<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_financial_inherit" inherit_id="accounting_pdf_reports.report_financial">

        <!-- Display warehouse selection info -->
        <xpath expr="//div[@class='row mt32 mb32']" position="after">
            <div class="row mb16" t-if="warehouse_display">
                <div class="col-12">
                    <strong>Warehouse Selection: </strong>
                    <span t-esc="warehouse_display"/>
                </div>
            </div>
        </xpath>

        <!-- Replace entire report body for multiple warehouse mode -->
        <xpath expr="//div[hasclass('page')]" position="replace">
            <div class="page">
                <!-- Keep original header -->
                <h2 t-if="data['form']['account_report_id']">
                    <span t-esc="data['form']['account_report_id'][1]"/>
                </h2>

                <!-- Date range info -->
                <div class="row mt32 mb32">
                    <div class="col-auto">
                        <strong>Target Moves: </strong>
                        <span t-if="data['form']['target_move'] == 'all'">All Entries</span>
                        <span t-if="data['form']['target_move'] == 'posted'">Posted Entries</span>
                    </div>
                    <div class="col-auto" t-if="data['form']['date_from']">
                        <strong>Date from: </strong>
                        <span t-esc="data['form']['date_from']"/>
                    </div>
                    <div class="col-auto" t-if="data['form']['date_to']">
                        <strong>to: </strong>
                        <span t-esc="data['form']['date_to']"/>
                    </div>
                </div>

                <!-- Warehouse selection info -->
                <div class="row mb16" t-if="warehouse_display">
                    <div class="col-12">
                        <strong>Warehouse Selection: </strong>
                        <span t-esc="warehouse_display"/>
                    </div>
                </div>

                <!-- Single warehouse or all warehouses combined -->
                <t t-if="not show_warehouse_breakdown">
                    <t t-call="accounting_pdf_reports.report_financial_lines"/>
                </t>

                <!-- Multiple warehouses - show each separately -->
                <t t-if="show_warehouse_breakdown">
                    <t t-foreach="warehouse_reports" t-as="warehouse_report">
                        <div class="warehouse-section" style="page-break-before: always; margin-top: 30px;">
                            <h3 style="background-color: #f0f0f0; padding: 10px; margin-bottom: 20px;">
                                <strong>Warehouse: </strong>
                                <span t-esc="warehouse_report['warehouse_name']"/>
                            </h3>

                            <!-- Use the warehouse-specific data -->
                            <t t-set="account_report_id" t-value="warehouse_report['report_data'].get('account_report_id')"/>
                            <t t-set="Accounts" t-value="warehouse_report['report_data'].get('Accounts')"/>
                            <t t-set="print_journal" t-value="warehouse_report['report_data'].get('print_journal')"/>
                            <t t-set="currency" t-value="warehouse_report['report_data'].get('currency')"/>

                            <t t-call="accounting_pdf_reports.report_financial_lines"/>
                        </div>
                    </t>

                    <!-- Combined report if requested -->
                    <t t-if="include_combined and combined_report_data">
                        <div class="warehouse-section" style="page-break-before: always; margin-top: 30px;">
                            <h3 style="background-color: #e0f0ff; padding: 10px; margin-bottom: 20px;">
                                <strong>COMBINED - All Selected Warehouses</strong>
                            </h3>

                            <!-- Use the combined data -->
                            <t t-set="account_report_id" t-value="combined_report_data.get('account_report_id')"/>
                            <t t-set="Accounts" t-value="combined_report_data.get('Accounts')"/>
                            <t t-set="print_journal" t-value="combined_report_data.get('print_journal')"/>
                            <t t-set="currency" t-value="combined_report_data.get('currency')"/>

                            <t t-call="accounting_pdf_reports.report_financial_lines"/>
                        </div>
                    </t>
                </t>
            </div>
        </xpath>
    </template>
</odoo>










<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->
<!--    <template id="report_financial_inherit" inherit_id="accounting_pdf_reports.report_financial">-->
<!--        <xpath expr="//div[@class='row mt32 mb32']" position="after">-->
<!--            <div class="row mb16" t-if="warehouse_display">-->
<!--                <div class="col-12">-->
<!--                    <strong>Warehouse Selection: </strong>-->
<!--                    <span t-esc="warehouse_display"/>-->
<!--                </div>-->
<!--            </div>-->
<!--        </xpath>-->
<!--    </template>-->
<!--</odoo>-->
