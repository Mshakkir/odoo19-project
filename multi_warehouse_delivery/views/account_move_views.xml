<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Add warehouse field to account.move.line model - simpler approach -->
    <record id="view_account_move_line_tree_warehouse" model="ir.ui.view">
        <field name="name">account.move.line.tree.warehouse</field>
        <field name="model">account.move.line</field>
        <field name="priority">999</field>
        <field name="arch" type="xml">
            <tree string="Invoice Lines">
                <field name="product_id"/>
                <field name="name"/>
                <field name="quantity"/>
                <field name="price_unit"/>
                <field name="warehouse_id"
                       optional="show"
                       widget="many2one"
                       options="{'no_create': True, 'no_open': True}"/>
                <field name="price_subtotal"/>
            </tree>
        </field>
    </record>

    <!-- Add warehouse field to account.move.line form view -->
    <record id="view_account_move_line_form_warehouse" model="ir.ui.view">
        <field name="name">account.move.line.form.warehouse</field>
        <field name="model">account.move.line</field>
        <field name="priority">999</field>
        <field name="arch" type="xml">
            <form string="Invoice Line">
                <group>
                    <group>
                        <field name="product_id"/>
                        <field name="warehouse_id"
                               options="{'no_create': True, 'no_open': True}"/>
                        <field name="quantity"/>
                        <field name="product_uom_id" groups="uom.group_uom"/>
                    </group>
                    <group>
                        <field name="price_unit"/>
                        <field name="discount" groups="product.group_discount_per_so_line"/>
                        <field name="price_subtotal"/>
                    </group>
                </group>
                <group>
                    <field name="name"/>
                </group>
            </form>
        </field>
    </record>
</odoo>