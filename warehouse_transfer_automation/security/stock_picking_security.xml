<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <!-- ========================================== -->
        <!-- STOCK PICKING ACCESS RULES -->
        <!-- ========================================== -->

        <!-- FYH Warehouse: See only FYH operations -->
        <record id="stock_picking_fyh_warehouse_rule" model="ir.rule">
            <field name="name">FYH Warehouse: See only FYH operations</field>
            <field name="model_id" ref="stock.model_stock_picking"/>
            <field name="groups" eval="[(4, ref('warehouse_transfer_automation.group_fyh_warehouse'))]"/>
            <field name="domain_force">[
                '|', '|', '|', '|',
                ('picking_type_id.warehouse_id.name', 'in', ['JED-Fyh', 'FYH']),
                ('location_id.warehouse_id.name', 'in', ['JED-Fyh', 'FYH']),
                ('location_dest_id.warehouse_id.name', 'in', ['JED-Fyh', 'FYH']),
                '&amp;', ('location_id.usage', '=', 'transit'), ('location_dest_id.warehouse_id.name', 'in', ['JED-Fyh', 'FYH']),
                '&amp;', ('location_dest_id.usage', '=', 'transit'), ('source_warehouse_id.name', 'in', ['JED-Fyh', 'FYH'])
            ]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- DMM Warehouse: See only DMM operations -->
        <record id="stock_picking_dmm_warehouse_rule" model="ir.rule">
            <field name="name">DMM Warehouse: See only DMM operations</field>
            <field name="model_id" ref="stock.model_stock_picking"/>
            <field name="groups" eval="[(4, ref('warehouse_transfer_automation.group_dmm_warehouse'))]"/>
            <field name="domain_force">[
                '|', '|', '|', '|',
                ('picking_type_id.warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM']),
                ('location_id.warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM']),
                ('location_dest_id.warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM']),
                '&amp;', ('location_id.usage', '=', 'transit'), ('location_dest_id.warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM']),
                '&amp;', ('location_dest_id.usage', '=', 'transit'), ('source_warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM'])
            ]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- BLD Warehouse: See only BLD operations -->
        <record id="stock_picking_bld_warehouse_rule" model="ir.rule">
            <field name="name">BLD Warehouse: See only BLD operations</field>
            <field name="model_id" ref="stock.model_stock_picking"/>
            <field name="groups" eval="[(4, ref('warehouse_transfer_automation.group_bld_warehouse'))]"/>
            <field name="domain_force">[
                '|', '|', '|', '|',
                ('picking_type_id.warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD']),
                ('location_id.warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD']),
                ('location_dest_id.warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD']),
                '&amp;', ('location_id.usage', '=', 'transit'), ('location_dest_id.warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD']),
                '&amp;', ('location_dest_id.usage', '=', 'transit'), ('source_warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD'])
            ]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- ========================================== -->
        <!-- STOCK LOCATION ACCESS RULES - RELAXED -->
        <!-- ========================================== -->

        <!-- ALL Stock Users: Can see all locations (read-only) -->
        <record id="stock_location_all_warehouses_read" model="ir.rule">
            <field name="name">All Warehouse Users: See all locations (read-only)</field>
            <field name="model_id" ref="stock.model_stock_location"/>
            <field name="groups" eval="[
                (4, ref('warehouse_transfer_automation.group_fyh_warehouse')),
                (4, ref('warehouse_transfer_automation.group_dmm_warehouse')),
                (4, ref('warehouse_transfer_automation.group_bld_warehouse'))
            ]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- ========================================== -->
        <!-- OPERATION TYPE ACCESS RULES - RELAXED -->
        <!-- ========================================== -->

        <!-- ALL Stock Users: Can see all operation types (read-only for others) -->
        <record id="stock_picking_type_all_warehouses_read" model="ir.rule">
            <field name="name">All Warehouse Users: See all operation types (read-only)</field>
            <field name="model_id" ref="stock.model_stock_picking_type"/>
            <field name="groups" eval="[
                (4, ref('warehouse_transfer_automation.group_fyh_warehouse')),
                (4, ref('warehouse_transfer_automation.group_dmm_warehouse')),
                (4, ref('warehouse_transfer_automation.group_bld_warehouse'))
            ]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
    </data>
</odoo>









<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<odoo>-->
<!--    <data noupdate="0">-->
<!--        &lt;!&ndash; ========================================== &ndash;&gt;-->
<!--        &lt;!&ndash; STOCK PICKING ACCESS RULES &ndash;&gt;-->
<!--        &lt;!&ndash; ========================================== &ndash;&gt;-->

<!--        &lt;!&ndash; FYH Warehouse: See only FYH operations &ndash;&gt;-->
<!--        <record id="stock_picking_fyh_warehouse_rule" model="ir.rule">-->
<!--            <field name="name">FYH Warehouse: See only FYH operations</field>-->
<!--            <field name="model_id" ref="stock.model_stock_picking"/>-->
<!--            <field name="groups" eval="[(4, ref('warehouse_transfer_automation.group_fyh_warehouse'))]"/>-->
<!--            <field name="domain_force">[-->
<!--                '|', '|', '|', '|',-->
<!--                ('picking_type_id.warehouse_id.name', 'in', ['JED-Fyh', 'FYH']),-->
<!--                ('location_id.warehouse_id.name', 'in', ['JED-Fyh', 'FYH']),-->
<!--                ('location_dest_id.warehouse_id.name', 'in', ['JED-Fyh', 'FYH']),-->
<!--                '&amp;', ('location_id.usage', '=', 'transit'), ('location_dest_id.warehouse_id.name', 'in', ['JED-Fyh', 'FYH']),-->
<!--                '&amp;', ('location_dest_id.usage', '=', 'transit'), ('source_warehouse_id.name', 'in', ['JED-Fyh', 'FYH'])-->
<!--            ]</field>-->
<!--            <field name="perm_read" eval="True"/>-->
<!--            <field name="perm_write" eval="True"/>-->
<!--            <field name="perm_create" eval="True"/>-->
<!--            <field name="perm_unlink" eval="True"/>-->
<!--        </record>-->

<!--        &lt;!&ndash; DMM Warehouse: See only DMM operations &ndash;&gt;-->
<!--        <record id="stock_picking_dmm_warehouse_rule" model="ir.rule">-->
<!--            <field name="name">DMM Warehouse: See only DMM operations</field>-->
<!--            <field name="model_id" ref="stock.model_stock_picking"/>-->
<!--            <field name="groups" eval="[(4, ref('warehouse_transfer_automation.group_dmm_warehouse'))]"/>-->
<!--            <field name="domain_force">[-->
<!--                '|', '|', '|', '|',-->
<!--                ('picking_type_id.warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM']),-->
<!--                ('location_id.warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM']),-->
<!--                ('location_dest_id.warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM']),-->
<!--                '&amp;', ('location_id.usage', '=', 'transit'), ('location_dest_id.warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM']),-->
<!--                '&amp;', ('location_dest_id.usage', '=', 'transit'), ('source_warehouse_id.name', 'in', ['DMM-Wh1', 'DMM', 'DAMMAM'])-->
<!--            ]</field>-->
<!--            <field name="perm_read" eval="True"/>-->
<!--            <field name="perm_write" eval="True"/>-->
<!--            <field name="perm_create" eval="True"/>-->
<!--            <field name="perm_unlink" eval="True"/>-->
<!--        </record>-->

<!--        &lt;!&ndash; BLD Warehouse: See only BLD operations &ndash;&gt;-->
<!--        <record id="stock_picking_bld_warehouse_rule" model="ir.rule">-->
<!--            <field name="name">BLD Warehouse: See only BLD operations</field>-->
<!--            <field name="model_id" ref="stock.model_stock_picking"/>-->
<!--            <field name="groups" eval="[(4, ref('warehouse_transfer_automation.group_bld_warehouse'))]"/>-->
<!--            <field name="domain_force">[-->
<!--                '|', '|', '|', '|',-->
<!--                ('picking_type_id.warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD']),-->
<!--                ('location_id.warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD']),-->
<!--                ('location_dest_id.warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD']),-->
<!--                '&amp;', ('location_id.usage', '=', 'transit'), ('location_dest_id.warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD']),-->
<!--                '&amp;', ('location_dest_id.usage', '=', 'transit'), ('source_warehouse_id.name', 'in', ['JED-Bld', 'BLD', 'BALADIYA', 'BALAD'])-->
<!--            ]</field>-->
<!--            <field name="perm_read" eval="True"/>-->
<!--            <field name="perm_write" eval="True"/>-->
<!--            <field name="perm_create" eval="True"/>-->
<!--            <field name="perm_unlink" eval="True"/>-->
<!--        </record>-->

<!--        &lt;!&ndash; ========================================== &ndash;&gt;-->
<!--        &lt;!&ndash; STOCK LOCATION ACCESS RULES - RELAXED &ndash;&gt;-->
<!--        &lt;!&ndash; All users can see all locations (needed for inter-warehouse transfers) &ndash;&gt;-->
<!--        &lt;!&ndash; ========================================== &ndash;&gt;-->

<!--        <record id="stock_location_all_warehouses_read" model="ir.rule">-->
<!--            <field name="name">All Warehouse Users: See all locations (read-only)</field>-->
<!--            <field name="model_id" ref="stock.model_stock_location"/>-->
<!--            <field name="groups" eval="[-->
<!--                (4, ref('warehouse_transfer_automation.group_fyh_warehouse')),-->
<!--                (4, ref('warehouse_transfer_automation.group_dmm_warehouse')),-->
<!--                (4, ref('warehouse_transfer_automation.group_bld_warehouse'))-->
<!--            ]"/>-->
<!--            <field name="domain_force">[(1, '=', 1)]</field>-->
<!--            <field name="perm_read" eval="True"/>-->
<!--            <field name="perm_write" eval="False"/>-->
<!--            <field name="perm_create" eval="False"/>-->
<!--            <field name="perm_unlink" eval="False"/>-->
<!--        </record>-->

<!--        &lt;!&ndash; ========================================== &ndash;&gt;-->
<!--        &lt;!&ndash; OPERATION TYPE (PICKING TYPE) ACCESS RULES &ndash;&gt;-->
<!--        &lt;!&ndash; TWO-TIER APPROACH: &ndash;&gt;-->
<!--        &lt;!&ndash; 1. Dashboard shows only own warehouse (write/create/delete) &ndash;&gt;-->
<!--        &lt;!&ndash; 2. But can READ all operation types (for inter-warehouse transfers) &ndash;&gt;-->
<!--        &lt;!&ndash; ========================================== &ndash;&gt;-->

<!--        &lt;!&ndash; ============================================ &ndash;&gt;-->
<!--        &lt;!&ndash; TIER 1: READ-ONLY ACCESS TO ALL OPERATION TYPES &ndash;&gt;-->
<!--        &lt;!&ndash; This allows users to validate transfers from other warehouses &ndash;&gt;-->
<!--        &lt;!&ndash; ============================================ &ndash;&gt;-->

<!--        <record id="stock_picking_type_all_read_only" model="ir.rule">-->
<!--            <field name="name">All Users: Can READ all operation types (for inter-warehouse transfers)</field>-->
<!--            <field name="model_id" ref="stock.model_stock_picking_type"/>-->
<!--            <field name="groups" eval="[-->
<!--                (4, ref('warehouse_transfer_automation.group_fyh_warehouse')),-->
<!--                (4, ref('warehouse_transfer_automation.group_dmm_warehouse')),-->
<!--                (4, ref('warehouse_transfer_automation.group_bld_warehouse'))-->
<!--            ]"/>-->
<!--            <field name="domain_force">[(1, '=', 1)]</field>-->
<!--            <field name="perm_read" eval="True"/>-->
<!--            <field name="perm_write" eval="False"/>-->
<!--            <field name="perm_create" eval="False"/>-->
<!--            <field name="perm_unlink" eval="False"/>-->
<!--        </record>-->

<!--        &lt;!&ndash; ============================================ &ndash;&gt;-->
<!--        &lt;!&ndash; TIER 2: FULL ACCESS TO OWN WAREHOUSE ONLY &ndash;&gt;-->
<!--        &lt;!&ndash; This restricts write/create/delete to own warehouse &ndash;&gt;-->
<!--        &lt;!&ndash; ============================================ &ndash;&gt;-->

<!--        &lt;!&ndash; FYH Users: Full access ONLY to JED-Fyh operation types &ndash;&gt;-->
<!--        <record id="stock_picking_type_fyh_full_access" model="ir.rule">-->
<!--            <field name="name">FYH Users: Full access ONLY to JED-Fyh operation types</field>-->
<!--            <field name="model_id" ref="stock.model_stock_picking_type"/>-->
<!--            <field name="groups" eval="[(4, ref('warehouse_transfer_automation.group_fyh_warehouse'))]"/>-->
<!--            <field name="domain_force">[('warehouse_id.name', '=', 'JED-Fyh')]</field>-->
<!--            <field name="perm_read" eval="False"/>-->
<!--            <field name="perm_write" eval="True"/>-->
<!--            <field name="perm_create" eval="True"/>-->
<!--            <field name="perm_unlink" eval="True"/>-->
<!--        </record>-->

<!--        &lt;!&ndash; DMM Users: Full access ONLY to DMM-Wh1 operation types &ndash;&gt;-->
<!--        <record id="stock_picking_type_dmm_full_access" model="ir.rule">-->
<!--            <field name="name">DMM Users: Full access ONLY to DMM-Wh1 operation types</field>-->
<!--            <field name="model_id" ref="stock.model_stock_picking_type"/>-->
<!--            <field name="groups" eval="[(4, ref('warehouse_transfer_automation.group_dmm_warehouse'))]"/>-->
<!--            <field name="domain_force">[('warehouse_id.name', '=', 'DMM-Wh1')]</field>-->
<!--            <field name="perm_read" eval="False"/>-->
<!--            <field name="perm_write" eval="True"/>-->
<!--            <field name="perm_create" eval="True"/>-->
<!--            <field name="perm_unlink" eval="True"/>-->
<!--        </record>-->

<!--        &lt;!&ndash; BLD Users: Full access ONLY to JED-Bld operation types &ndash;&gt;-->
<!--        <record id="stock_picking_type_bld_full_access" model="ir.rule">-->
<!--            <field name="name">BLD Users: Full access ONLY to JED-Bld operation types</field>-->
<!--            <field name="model_id" ref="stock.model_stock_picking_type"/>-->
<!--            <field name="groups" eval="[(4, ref('warehouse_transfer_automation.group_bld_warehouse'))]"/>-->
<!--            <field name="domain_force">[('warehouse_id.name', '=', 'JED-Bld')]</field>-->
<!--            <field name="perm_read" eval="False"/>-->
<!--            <field name="perm_write" eval="True"/>-->
<!--            <field name="perm_create" eval="True"/>-->
<!--            <field name="perm_unlink" eval="True"/>-->
<!--        </record>-->

<!--    </data>-->
<!--</odoo>-->