<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_picking_form_partner_balance" model="ir.ui.view">
        <field name="name">stock.picking.form.partner.balance</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">

            <!-- Make currency_id available -->
            <field name="partner_id" position="before">
                <field name="currency_id" invisible="1"/>
            </field>

            <!-- Add balance info in a new page inside the notebook -->
            <xpath expr="//notebook" position="inside">
                <page string="Partner Balance" invisible="not partner_id">
                    <group>
                        <group string="Financial Summary">
                            <!-- Total Invoiced/Billed -->
                            <label for="partner_total_invoiced" string="Total Invoiced/Billed"/>
                            <div class="o_row">
                                <field name="partner_total_invoiced"
                                       widget="monetary"
                                       options="{'currency_field': 'currency_id'}"
                                       readonly="1"
                                       nolabel="1"
                                       force_save="1"/>
                                <button name="action_view_partner_invoices"
                                        type="object"
                                        string="üìÑ View Invoices/Bills"
                                        class="btn-link"
                                        invisible="partner_total_invoiced == 0"/>
                            </div>

                            <!-- Amount Paid -->
                            <label for="partner_total_paid" string="Amount Paid"/>
                            <div class="o_row">
                                <field name="partner_total_paid"
                                       widget="monetary"
                                       options="{'currency_field': 'currency_id'}"
                                       readonly="1"
                                       decoration-success="partner_total_paid &gt; 0"
                                       nolabel="1"
                                       force_save="1"/>
                                <button name="action_view_partner_payments"
                                        type="object"
                                        string="üí∞ View Payments"
                                        class="btn-link"
                                        invisible="partner_total_paid == 0"/>
                            </div>

                            <!-- Balance Due -->
                            <label for="partner_balance_due" string="Balance Due" class="fw-bold"/>
                            <field name="partner_balance_due"
                                   widget="monetary"
                                   options="{'currency_field': 'currency_id'}"
                                   readonly="1"
                                   decoration-danger="partner_balance_due &gt; 0"
                                   decoration-success="partner_balance_due == 0"
                                   nolabel="1"
                                   class="fw-bold"
                                   force_save="1"/>
                        </group>

                        <group>
                            <div class="alert alert-info" role="alert" style="margin-top: 20px;">
                                <strong>‚ÑπÔ∏è About these values:</strong>
                                <ul style="margin-bottom: 0;">
                                    <li>These figures show ALL posted invoices/bills for this partner</li>
                                    <li>Values are calculated in real-time</li>
                                    <li>Click the buttons to view detailed transactions</li>
                                </ul>
                            </div>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
</odoo>